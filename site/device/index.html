
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://example.com/device/">
      
      
        <link rel="prev" href="../compare/">
      
      
        <link rel="next" href="../geometry/">
      
      
      <link rel="icon" href="../assets/favicon.ico">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.5.17">
    
    
      
        <title>Device - PreFab Documentation</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.bcfcd587.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../css/ansi-colours.css">
    
      <link rel="stylesheet" href="../css/jupyter-cells.css">
    
      <link rel="stylesheet" href="../css/pandas-dataframe.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="green">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#device" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="https://prefabphotonics.com" title="PreFab Documentation" class="md-header__button md-logo" aria-label="PreFab Documentation" data-md-component="logo">
      
  <img src="../assets/logo_neue.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            PreFab Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Device
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/PreFab-Photonics/PreFab" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    PreFab-Photonics/PreFab
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="https://prefabphotonics.com" title="PreFab Documentation" class="md-nav__button md-logo" aria-label="PreFab Documentation" data-md-component="logo">
      
  <img src="../assets/logo_neue.svg" alt="logo">

    </a>
    PreFab Documentation
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/PreFab-Photonics/PreFab" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    PreFab-Photonics/PreFab
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Welcome to MkDocs
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../compare/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Compare
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Device
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Device
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#prefab.device" class="md-nav__link">
    <span class="md-ellipsis">
      device
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prefab.device.BufferSpec" class="md-nav__link">
    <span class="md-ellipsis">
      BufferSpec
    </span>
  </a>
  
    <nav class="md-nav" aria-label="BufferSpec">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#prefab.device.BufferSpec--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefab.device.BufferSpec--raises" class="md-nav__link">
    <span class="md-ellipsis">
      Raises
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefab.device.BufferSpec--example" class="md-nav__link">
    <span class="md-ellipsis">
      Example
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prefab.device.Device" class="md-nav__link">
    <span class="md-ellipsis">
      Device
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Device">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#prefab.device.Device.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
    <nav class="md-nav" aria-label="__init__">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#prefab.device.Device.__init__--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefab.device.Device.__init__--attributes" class="md-nav__link">
    <span class="md-ellipsis">
      Attributes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefab.device.Device.__init__--raises" class="md-nav__link">
    <span class="md-ellipsis">
      Raises
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefab.device.Device.binarize" class="md-nav__link">
    <span class="md-ellipsis">
      binarize
    </span>
  </a>
  
    <nav class="md-nav" aria-label="binarize">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#prefab.device.Device.binarize--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefab.device.Device.binarize--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefab.device.Device.binarize_hard" class="md-nav__link">
    <span class="md-ellipsis">
      binarize_hard
    </span>
  </a>
  
    <nav class="md-nav" aria-label="binarize_hard">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#prefab.device.Device.binarize_hard--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefab.device.Device.binarize_hard--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefab.device.Device.binarize_monte_carlo" class="md-nav__link">
    <span class="md-ellipsis">
      binarize_monte_carlo
    </span>
  </a>
  
    <nav class="md-nav" aria-label="binarize_monte_carlo">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#prefab.device.Device.binarize_monte_carlo--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefab.device.Device.binarize_monte_carlo--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefab.device.Device.blur" class="md-nav__link">
    <span class="md-ellipsis">
      blur
    </span>
  </a>
  
    <nav class="md-nav" aria-label="blur">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#prefab.device.Device.blur--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefab.device.Device.blur--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefab.device.Device.correct" class="md-nav__link">
    <span class="md-ellipsis">
      correct
    </span>
  </a>
  
    <nav class="md-nav" aria-label="correct">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#prefab.device.Device.correct--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefab.device.Device.correct--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefab.device.Device.correct--raises" class="md-nav__link">
    <span class="md-ellipsis">
      Raises
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefab.device.Device.dilate" class="md-nav__link">
    <span class="md-ellipsis">
      dilate
    </span>
  </a>
  
    <nav class="md-nav" aria-label="dilate">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#prefab.device.Device.dilate--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefab.device.Device.dilate--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefab.device.Device.erode" class="md-nav__link">
    <span class="md-ellipsis">
      erode
    </span>
  </a>
  
    <nav class="md-nav" aria-label="erode">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#prefab.device.Device.erode--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefab.device.Device.erode--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefab.device.Device.is_binary" class="md-nav__link">
    <span class="md-ellipsis">
      is_binary
    </span>
  </a>
  
    <nav class="md-nav" aria-label="is_binary">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#prefab.device.Device.is_binary--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefab.device.Device.normalize" class="md-nav__link">
    <span class="md-ellipsis">
      normalize
    </span>
  </a>
  
    <nav class="md-nav" aria-label="normalize">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#prefab.device.Device.normalize--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefab.device.Device.plot" class="md-nav__link">
    <span class="md-ellipsis">
      plot
    </span>
  </a>
  
    <nav class="md-nav" aria-label="plot">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#prefab.device.Device.plot--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefab.device.Device.plot--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefab.device.Device.plot_contour" class="md-nav__link">
    <span class="md-ellipsis">
      plot_contour
    </span>
  </a>
  
    <nav class="md-nav" aria-label="plot_contour">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#prefab.device.Device.plot_contour--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefab.device.Device.plot_contour--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefab.device.Device.plot_uncertainty" class="md-nav__link">
    <span class="md-ellipsis">
      plot_uncertainty
    </span>
  </a>
  
    <nav class="md-nav" aria-label="plot_uncertainty">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#prefab.device.Device.plot_uncertainty--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefab.device.Device.plot_uncertainty--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefab.device.Device.predict" class="md-nav__link">
    <span class="md-ellipsis">
      predict
    </span>
  </a>
  
    <nav class="md-nav" aria-label="predict">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#prefab.device.Device.predict--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefab.device.Device.predict--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefab.device.Device.predict--raises" class="md-nav__link">
    <span class="md-ellipsis">
      Raises
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefab.device.Device.rotate" class="md-nav__link">
    <span class="md-ellipsis">
      rotate
    </span>
  </a>
  
    <nav class="md-nav" aria-label="rotate">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#prefab.device.Device.rotate--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefab.device.Device.rotate--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefab.device.Device.semulate" class="md-nav__link">
    <span class="md-ellipsis">
      semulate
    </span>
  </a>
  
    <nav class="md-nav" aria-label="semulate">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#prefab.device.Device.semulate--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefab.device.Device.semulate--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefab.device.Device.ternarize" class="md-nav__link">
    <span class="md-ellipsis">
      ternarize
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ternarize">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#prefab.device.Device.ternarize--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefab.device.Device.ternarize--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefab.device.Device.to_gds" class="md-nav__link">
    <span class="md-ellipsis">
      to_gds
    </span>
  </a>
  
    <nav class="md-nav" aria-label="to_gds">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#prefab.device.Device.to_gds--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefab.device.Device.to_gdstk" class="md-nav__link">
    <span class="md-ellipsis">
      to_gdstk
    </span>
  </a>
  
    <nav class="md-nav" aria-label="to_gdstk">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#prefab.device.Device.to_gdstk--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefab.device.Device.to_gdstk--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefab.device.Device.to_img" class="md-nav__link">
    <span class="md-ellipsis">
      to_img
    </span>
  </a>
  
    <nav class="md-nav" aria-label="to_img">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#prefab.device.Device.to_img--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefab.device.Device.to_ndarray" class="md-nav__link">
    <span class="md-ellipsis">
      to_ndarray
    </span>
  </a>
  
    <nav class="md-nav" aria-label="to_ndarray">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#prefab.device.Device.to_ndarray--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefab.device.Device.trim" class="md-nav__link">
    <span class="md-ellipsis">
      trim
    </span>
  </a>
  
    <nav class="md-nav" aria-label="trim">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#prefab.device.Device.trim--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefab.device.Device.trim--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../geometry/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Geometry
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../models/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Models
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../read/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Read
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Examples
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            Examples
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/1_prediction/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1 prediction
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/2_prediction_gds/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2 prediction gds
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/3_correction/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3 correction
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/4_prediction_silicon_nitride/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    4 prediction silicon nitride
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#prefab.device" class="md-nav__link">
    <span class="md-ellipsis">
      device
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prefab.device.BufferSpec" class="md-nav__link">
    <span class="md-ellipsis">
      BufferSpec
    </span>
  </a>
  
    <nav class="md-nav" aria-label="BufferSpec">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#prefab.device.BufferSpec--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefab.device.BufferSpec--raises" class="md-nav__link">
    <span class="md-ellipsis">
      Raises
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefab.device.BufferSpec--example" class="md-nav__link">
    <span class="md-ellipsis">
      Example
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prefab.device.Device" class="md-nav__link">
    <span class="md-ellipsis">
      Device
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Device">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#prefab.device.Device.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
    <nav class="md-nav" aria-label="__init__">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#prefab.device.Device.__init__--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefab.device.Device.__init__--attributes" class="md-nav__link">
    <span class="md-ellipsis">
      Attributes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefab.device.Device.__init__--raises" class="md-nav__link">
    <span class="md-ellipsis">
      Raises
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefab.device.Device.binarize" class="md-nav__link">
    <span class="md-ellipsis">
      binarize
    </span>
  </a>
  
    <nav class="md-nav" aria-label="binarize">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#prefab.device.Device.binarize--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefab.device.Device.binarize--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefab.device.Device.binarize_hard" class="md-nav__link">
    <span class="md-ellipsis">
      binarize_hard
    </span>
  </a>
  
    <nav class="md-nav" aria-label="binarize_hard">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#prefab.device.Device.binarize_hard--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefab.device.Device.binarize_hard--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefab.device.Device.binarize_monte_carlo" class="md-nav__link">
    <span class="md-ellipsis">
      binarize_monte_carlo
    </span>
  </a>
  
    <nav class="md-nav" aria-label="binarize_monte_carlo">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#prefab.device.Device.binarize_monte_carlo--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefab.device.Device.binarize_monte_carlo--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefab.device.Device.blur" class="md-nav__link">
    <span class="md-ellipsis">
      blur
    </span>
  </a>
  
    <nav class="md-nav" aria-label="blur">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#prefab.device.Device.blur--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefab.device.Device.blur--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefab.device.Device.correct" class="md-nav__link">
    <span class="md-ellipsis">
      correct
    </span>
  </a>
  
    <nav class="md-nav" aria-label="correct">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#prefab.device.Device.correct--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefab.device.Device.correct--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefab.device.Device.correct--raises" class="md-nav__link">
    <span class="md-ellipsis">
      Raises
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefab.device.Device.dilate" class="md-nav__link">
    <span class="md-ellipsis">
      dilate
    </span>
  </a>
  
    <nav class="md-nav" aria-label="dilate">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#prefab.device.Device.dilate--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefab.device.Device.dilate--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefab.device.Device.erode" class="md-nav__link">
    <span class="md-ellipsis">
      erode
    </span>
  </a>
  
    <nav class="md-nav" aria-label="erode">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#prefab.device.Device.erode--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefab.device.Device.erode--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefab.device.Device.is_binary" class="md-nav__link">
    <span class="md-ellipsis">
      is_binary
    </span>
  </a>
  
    <nav class="md-nav" aria-label="is_binary">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#prefab.device.Device.is_binary--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefab.device.Device.normalize" class="md-nav__link">
    <span class="md-ellipsis">
      normalize
    </span>
  </a>
  
    <nav class="md-nav" aria-label="normalize">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#prefab.device.Device.normalize--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefab.device.Device.plot" class="md-nav__link">
    <span class="md-ellipsis">
      plot
    </span>
  </a>
  
    <nav class="md-nav" aria-label="plot">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#prefab.device.Device.plot--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefab.device.Device.plot--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefab.device.Device.plot_contour" class="md-nav__link">
    <span class="md-ellipsis">
      plot_contour
    </span>
  </a>
  
    <nav class="md-nav" aria-label="plot_contour">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#prefab.device.Device.plot_contour--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefab.device.Device.plot_contour--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefab.device.Device.plot_uncertainty" class="md-nav__link">
    <span class="md-ellipsis">
      plot_uncertainty
    </span>
  </a>
  
    <nav class="md-nav" aria-label="plot_uncertainty">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#prefab.device.Device.plot_uncertainty--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefab.device.Device.plot_uncertainty--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefab.device.Device.predict" class="md-nav__link">
    <span class="md-ellipsis">
      predict
    </span>
  </a>
  
    <nav class="md-nav" aria-label="predict">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#prefab.device.Device.predict--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefab.device.Device.predict--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefab.device.Device.predict--raises" class="md-nav__link">
    <span class="md-ellipsis">
      Raises
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefab.device.Device.rotate" class="md-nav__link">
    <span class="md-ellipsis">
      rotate
    </span>
  </a>
  
    <nav class="md-nav" aria-label="rotate">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#prefab.device.Device.rotate--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefab.device.Device.rotate--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefab.device.Device.semulate" class="md-nav__link">
    <span class="md-ellipsis">
      semulate
    </span>
  </a>
  
    <nav class="md-nav" aria-label="semulate">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#prefab.device.Device.semulate--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefab.device.Device.semulate--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefab.device.Device.ternarize" class="md-nav__link">
    <span class="md-ellipsis">
      ternarize
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ternarize">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#prefab.device.Device.ternarize--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefab.device.Device.ternarize--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefab.device.Device.to_gds" class="md-nav__link">
    <span class="md-ellipsis">
      to_gds
    </span>
  </a>
  
    <nav class="md-nav" aria-label="to_gds">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#prefab.device.Device.to_gds--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefab.device.Device.to_gdstk" class="md-nav__link">
    <span class="md-ellipsis">
      to_gdstk
    </span>
  </a>
  
    <nav class="md-nav" aria-label="to_gdstk">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#prefab.device.Device.to_gdstk--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefab.device.Device.to_gdstk--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefab.device.Device.to_img" class="md-nav__link">
    <span class="md-ellipsis">
      to_img
    </span>
  </a>
  
    <nav class="md-nav" aria-label="to_img">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#prefab.device.Device.to_img--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefab.device.Device.to_ndarray" class="md-nav__link">
    <span class="md-ellipsis">
      to_ndarray
    </span>
  </a>
  
    <nav class="md-nav" aria-label="to_ndarray">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#prefab.device.Device.to_ndarray--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefab.device.Device.trim" class="md-nav__link">
    <span class="md-ellipsis">
      trim
    </span>
  </a>
  
    <nav class="md-nav" aria-label="trim">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#prefab.device.Device.trim--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefab.device.Device.trim--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="device">Device</h1>


<div class="doc doc-object doc-module">



<a id="prefab.device"></a>
  <div class="doc doc-contents first">
  
      <p>Provides the Device class for representing photonic devices.</p>

  

  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="prefab.device.BufferSpec" class="doc doc-heading">
          <code>BufferSpec</code>


</h2>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><span title="pydantic.BaseModel">BaseModel</span></code></p>

  
      <p>Defines the specifications for a buffer zone around a device.</p>
<p>This class is used to specify the mode and thickness of a buffer zone that is added
around the device geometry. The buffer zone can be used for various purposes such as
providing extra space for device fabrication processes or for ensuring that the
device is isolated from surrounding structures.</p>
<h4 id="prefab.device.BufferSpec--parameters">Parameters</h4>
<p>mode : dict[str, str]
    A dictionary that defines the buffer mode for each side of the device
    ('top', 'bottom', 'left', 'right'), where 'constant' is used for isolated
    structures and 'edge' is utilized for preserving the edge, such as for waveguide
    connections.
thickness : conint(gt=0)
    The thickness of the buffer zone around the device. Must be greater than 0.</p>
<h4 id="prefab.device.BufferSpec--raises">Raises</h4>
<p>ValueError
    If any of the modes specified in the 'mode' dictionary are not one of the
    allowed values ('constant', 'edge'). Or if the thickness is not greater than 0.</p>
<h4 id="prefab.device.BufferSpec--example">Example</h4>
<blockquote>
<blockquote>
<blockquote>
<p>import prefab as pf
buffer_spec = pf.BufferSpec(
...     mode={
...         "top": "constant",
...         "bottom": "edge",
...         "left": "constant",
...         "right": "edge"
...     },
...     thickness=150
... )</p>
</blockquote>
</blockquote>
</blockquote>

            <details class="quote">
              <summary>Source code in <code>prefab/device.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">BufferSpec</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Defines the specifications for a buffer zone around a device.</span>

<span class="sd">    This class is used to specify the mode and thickness of a buffer zone that is added</span>
<span class="sd">    around the device geometry. The buffer zone can be used for various purposes such as</span>
<span class="sd">    providing extra space for device fabrication processes or for ensuring that the</span>
<span class="sd">    device is isolated from surrounding structures.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    mode : dict[str, str]</span>
<span class="sd">        A dictionary that defines the buffer mode for each side of the device</span>
<span class="sd">        (&#39;top&#39;, &#39;bottom&#39;, &#39;left&#39;, &#39;right&#39;), where &#39;constant&#39; is used for isolated</span>
<span class="sd">        structures and &#39;edge&#39; is utilized for preserving the edge, such as for waveguide</span>
<span class="sd">        connections.</span>
<span class="sd">    thickness : conint(gt=0)</span>
<span class="sd">        The thickness of the buffer zone around the device. Must be greater than 0.</span>

<span class="sd">    Raises</span>
<span class="sd">    ------</span>
<span class="sd">    ValueError</span>
<span class="sd">        If any of the modes specified in the &#39;mode&#39; dictionary are not one of the</span>
<span class="sd">        allowed values (&#39;constant&#39;, &#39;edge&#39;). Or if the thickness is not greater than 0.</span>

<span class="sd">    Example</span>
<span class="sd">    -------</span>
<span class="sd">    &gt;&gt;&gt; import prefab as pf</span>
<span class="sd">    &gt;&gt;&gt; buffer_spec = pf.BufferSpec(</span>
<span class="sd">    ...     mode={</span>
<span class="sd">    ...         &quot;top&quot;: &quot;constant&quot;,</span>
<span class="sd">    ...         &quot;bottom&quot;: &quot;edge&quot;,</span>
<span class="sd">    ...         &quot;left&quot;: &quot;constant&quot;,</span>
<span class="sd">    ...         &quot;right&quot;: &quot;edge&quot;</span>
<span class="sd">    ...     },</span>
<span class="sd">    ...     thickness=150</span>
<span class="sd">    ... )</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">mode</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
        <span class="n">default_factory</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;top&quot;</span><span class="p">:</span> <span class="s2">&quot;constant&quot;</span><span class="p">,</span>
            <span class="s2">&quot;bottom&quot;</span><span class="p">:</span> <span class="s2">&quot;constant&quot;</span><span class="p">,</span>
            <span class="s2">&quot;left&quot;</span><span class="p">:</span> <span class="s2">&quot;constant&quot;</span><span class="p">,</span>
            <span class="s2">&quot;right&quot;</span><span class="p">:</span> <span class="s2">&quot;constant&quot;</span><span class="p">,</span>
        <span class="p">}</span>
    <span class="p">)</span>
    <span class="n">thickness</span><span class="p">:</span> <span class="n">conint</span><span class="p">(</span><span class="n">gt</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="o">=</span> <span class="mi">128</span>

    <span class="nd">@validator</span><span class="p">(</span><span class="s2">&quot;mode&quot;</span><span class="p">,</span> <span class="n">pre</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">check_mode</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">v</span><span class="p">):</span>
        <span class="n">allowed_modes</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;constant&quot;</span><span class="p">,</span> <span class="s2">&quot;edge&quot;</span><span class="p">]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="n">mode</span> <span class="ow">in</span> <span class="n">allowed_modes</span> <span class="k">for</span> <span class="n">mode</span> <span class="ow">in</span> <span class="n">v</span><span class="o">.</span><span class="n">values</span><span class="p">()):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Buffer mode must be one of </span><span class="si">{</span><span class="n">allowed_modes</span><span class="si">}</span><span class="s2">, got &#39;</span><span class="si">{</span><span class="n">v</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">v</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">











  </div>

  </div>


</div>

<div class="doc doc-object doc-class">



<h2 id="prefab.device.Device" class="doc doc-heading">
          <code>Device</code>


</h2>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><span title="pydantic.BaseModel">BaseModel</span></code></p>


            <details class="quote">
              <summary>Source code in <code>prefab/device.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">  79</span>
<span class="normal">  80</span>
<span class="normal">  81</span>
<span class="normal">  82</span>
<span class="normal">  83</span>
<span class="normal">  84</span>
<span class="normal">  85</span>
<span class="normal">  86</span>
<span class="normal">  87</span>
<span class="normal">  88</span>
<span class="normal">  89</span>
<span class="normal">  90</span>
<span class="normal">  91</span>
<span class="normal">  92</span>
<span class="normal">  93</span>
<span class="normal">  94</span>
<span class="normal">  95</span>
<span class="normal">  96</span>
<span class="normal">  97</span>
<span class="normal">  98</span>
<span class="normal">  99</span>
<span class="normal"> 100</span>
<span class="normal"> 101</span>
<span class="normal"> 102</span>
<span class="normal"> 103</span>
<span class="normal"> 104</span>
<span class="normal"> 105</span>
<span class="normal"> 106</span>
<span class="normal"> 107</span>
<span class="normal"> 108</span>
<span class="normal"> 109</span>
<span class="normal"> 110</span>
<span class="normal"> 111</span>
<span class="normal"> 112</span>
<span class="normal"> 113</span>
<span class="normal"> 114</span>
<span class="normal"> 115</span>
<span class="normal"> 116</span>
<span class="normal"> 117</span>
<span class="normal"> 118</span>
<span class="normal"> 119</span>
<span class="normal"> 120</span>
<span class="normal"> 121</span>
<span class="normal"> 122</span>
<span class="normal"> 123</span>
<span class="normal"> 124</span>
<span class="normal"> 125</span>
<span class="normal"> 126</span>
<span class="normal"> 127</span>
<span class="normal"> 128</span>
<span class="normal"> 129</span>
<span class="normal"> 130</span>
<span class="normal"> 131</span>
<span class="normal"> 132</span>
<span class="normal"> 133</span>
<span class="normal"> 134</span>
<span class="normal"> 135</span>
<span class="normal"> 136</span>
<span class="normal"> 137</span>
<span class="normal"> 138</span>
<span class="normal"> 139</span>
<span class="normal"> 140</span>
<span class="normal"> 141</span>
<span class="normal"> 142</span>
<span class="normal"> 143</span>
<span class="normal"> 144</span>
<span class="normal"> 145</span>
<span class="normal"> 146</span>
<span class="normal"> 147</span>
<span class="normal"> 148</span>
<span class="normal"> 149</span>
<span class="normal"> 150</span>
<span class="normal"> 151</span>
<span class="normal"> 152</span>
<span class="normal"> 153</span>
<span class="normal"> 154</span>
<span class="normal"> 155</span>
<span class="normal"> 156</span>
<span class="normal"> 157</span>
<span class="normal"> 158</span>
<span class="normal"> 159</span>
<span class="normal"> 160</span>
<span class="normal"> 161</span>
<span class="normal"> 162</span>
<span class="normal"> 163</span>
<span class="normal"> 164</span>
<span class="normal"> 165</span>
<span class="normal"> 166</span>
<span class="normal"> 167</span>
<span class="normal"> 168</span>
<span class="normal"> 169</span>
<span class="normal"> 170</span>
<span class="normal"> 171</span>
<span class="normal"> 172</span>
<span class="normal"> 173</span>
<span class="normal"> 174</span>
<span class="normal"> 175</span>
<span class="normal"> 176</span>
<span class="normal"> 177</span>
<span class="normal"> 178</span>
<span class="normal"> 179</span>
<span class="normal"> 180</span>
<span class="normal"> 181</span>
<span class="normal"> 182</span>
<span class="normal"> 183</span>
<span class="normal"> 184</span>
<span class="normal"> 185</span>
<span class="normal"> 186</span>
<span class="normal"> 187</span>
<span class="normal"> 188</span>
<span class="normal"> 189</span>
<span class="normal"> 190</span>
<span class="normal"> 191</span>
<span class="normal"> 192</span>
<span class="normal"> 193</span>
<span class="normal"> 194</span>
<span class="normal"> 195</span>
<span class="normal"> 196</span>
<span class="normal"> 197</span>
<span class="normal"> 198</span>
<span class="normal"> 199</span>
<span class="normal"> 200</span>
<span class="normal"> 201</span>
<span class="normal"> 202</span>
<span class="normal"> 203</span>
<span class="normal"> 204</span>
<span class="normal"> 205</span>
<span class="normal"> 206</span>
<span class="normal"> 207</span>
<span class="normal"> 208</span>
<span class="normal"> 209</span>
<span class="normal"> 210</span>
<span class="normal"> 211</span>
<span class="normal"> 212</span>
<span class="normal"> 213</span>
<span class="normal"> 214</span>
<span class="normal"> 215</span>
<span class="normal"> 216</span>
<span class="normal"> 217</span>
<span class="normal"> 218</span>
<span class="normal"> 219</span>
<span class="normal"> 220</span>
<span class="normal"> 221</span>
<span class="normal"> 222</span>
<span class="normal"> 223</span>
<span class="normal"> 224</span>
<span class="normal"> 225</span>
<span class="normal"> 226</span>
<span class="normal"> 227</span>
<span class="normal"> 228</span>
<span class="normal"> 229</span>
<span class="normal"> 230</span>
<span class="normal"> 231</span>
<span class="normal"> 232</span>
<span class="normal"> 233</span>
<span class="normal"> 234</span>
<span class="normal"> 235</span>
<span class="normal"> 236</span>
<span class="normal"> 237</span>
<span class="normal"> 238</span>
<span class="normal"> 239</span>
<span class="normal"> 240</span>
<span class="normal"> 241</span>
<span class="normal"> 242</span>
<span class="normal"> 243</span>
<span class="normal"> 244</span>
<span class="normal"> 245</span>
<span class="normal"> 246</span>
<span class="normal"> 247</span>
<span class="normal"> 248</span>
<span class="normal"> 249</span>
<span class="normal"> 250</span>
<span class="normal"> 251</span>
<span class="normal"> 252</span>
<span class="normal"> 253</span>
<span class="normal"> 254</span>
<span class="normal"> 255</span>
<span class="normal"> 256</span>
<span class="normal"> 257</span>
<span class="normal"> 258</span>
<span class="normal"> 259</span>
<span class="normal"> 260</span>
<span class="normal"> 261</span>
<span class="normal"> 262</span>
<span class="normal"> 263</span>
<span class="normal"> 264</span>
<span class="normal"> 265</span>
<span class="normal"> 266</span>
<span class="normal"> 267</span>
<span class="normal"> 268</span>
<span class="normal"> 269</span>
<span class="normal"> 270</span>
<span class="normal"> 271</span>
<span class="normal"> 272</span>
<span class="normal"> 273</span>
<span class="normal"> 274</span>
<span class="normal"> 275</span>
<span class="normal"> 276</span>
<span class="normal"> 277</span>
<span class="normal"> 278</span>
<span class="normal"> 279</span>
<span class="normal"> 280</span>
<span class="normal"> 281</span>
<span class="normal"> 282</span>
<span class="normal"> 283</span>
<span class="normal"> 284</span>
<span class="normal"> 285</span>
<span class="normal"> 286</span>
<span class="normal"> 287</span>
<span class="normal"> 288</span>
<span class="normal"> 289</span>
<span class="normal"> 290</span>
<span class="normal"> 291</span>
<span class="normal"> 292</span>
<span class="normal"> 293</span>
<span class="normal"> 294</span>
<span class="normal"> 295</span>
<span class="normal"> 296</span>
<span class="normal"> 297</span>
<span class="normal"> 298</span>
<span class="normal"> 299</span>
<span class="normal"> 300</span>
<span class="normal"> 301</span>
<span class="normal"> 302</span>
<span class="normal"> 303</span>
<span class="normal"> 304</span>
<span class="normal"> 305</span>
<span class="normal"> 306</span>
<span class="normal"> 307</span>
<span class="normal"> 308</span>
<span class="normal"> 309</span>
<span class="normal"> 310</span>
<span class="normal"> 311</span>
<span class="normal"> 312</span>
<span class="normal"> 313</span>
<span class="normal"> 314</span>
<span class="normal"> 315</span>
<span class="normal"> 316</span>
<span class="normal"> 317</span>
<span class="normal"> 318</span>
<span class="normal"> 319</span>
<span class="normal"> 320</span>
<span class="normal"> 321</span>
<span class="normal"> 322</span>
<span class="normal"> 323</span>
<span class="normal"> 324</span>
<span class="normal"> 325</span>
<span class="normal"> 326</span>
<span class="normal"> 327</span>
<span class="normal"> 328</span>
<span class="normal"> 329</span>
<span class="normal"> 330</span>
<span class="normal"> 331</span>
<span class="normal"> 332</span>
<span class="normal"> 333</span>
<span class="normal"> 334</span>
<span class="normal"> 335</span>
<span class="normal"> 336</span>
<span class="normal"> 337</span>
<span class="normal"> 338</span>
<span class="normal"> 339</span>
<span class="normal"> 340</span>
<span class="normal"> 341</span>
<span class="normal"> 342</span>
<span class="normal"> 343</span>
<span class="normal"> 344</span>
<span class="normal"> 345</span>
<span class="normal"> 346</span>
<span class="normal"> 347</span>
<span class="normal"> 348</span>
<span class="normal"> 349</span>
<span class="normal"> 350</span>
<span class="normal"> 351</span>
<span class="normal"> 352</span>
<span class="normal"> 353</span>
<span class="normal"> 354</span>
<span class="normal"> 355</span>
<span class="normal"> 356</span>
<span class="normal"> 357</span>
<span class="normal"> 358</span>
<span class="normal"> 359</span>
<span class="normal"> 360</span>
<span class="normal"> 361</span>
<span class="normal"> 362</span>
<span class="normal"> 363</span>
<span class="normal"> 364</span>
<span class="normal"> 365</span>
<span class="normal"> 366</span>
<span class="normal"> 367</span>
<span class="normal"> 368</span>
<span class="normal"> 369</span>
<span class="normal"> 370</span>
<span class="normal"> 371</span>
<span class="normal"> 372</span>
<span class="normal"> 373</span>
<span class="normal"> 374</span>
<span class="normal"> 375</span>
<span class="normal"> 376</span>
<span class="normal"> 377</span>
<span class="normal"> 378</span>
<span class="normal"> 379</span>
<span class="normal"> 380</span>
<span class="normal"> 381</span>
<span class="normal"> 382</span>
<span class="normal"> 383</span>
<span class="normal"> 384</span>
<span class="normal"> 385</span>
<span class="normal"> 386</span>
<span class="normal"> 387</span>
<span class="normal"> 388</span>
<span class="normal"> 389</span>
<span class="normal"> 390</span>
<span class="normal"> 391</span>
<span class="normal"> 392</span>
<span class="normal"> 393</span>
<span class="normal"> 394</span>
<span class="normal"> 395</span>
<span class="normal"> 396</span>
<span class="normal"> 397</span>
<span class="normal"> 398</span>
<span class="normal"> 399</span>
<span class="normal"> 400</span>
<span class="normal"> 401</span>
<span class="normal"> 402</span>
<span class="normal"> 403</span>
<span class="normal"> 404</span>
<span class="normal"> 405</span>
<span class="normal"> 406</span>
<span class="normal"> 407</span>
<span class="normal"> 408</span>
<span class="normal"> 409</span>
<span class="normal"> 410</span>
<span class="normal"> 411</span>
<span class="normal"> 412</span>
<span class="normal"> 413</span>
<span class="normal"> 414</span>
<span class="normal"> 415</span>
<span class="normal"> 416</span>
<span class="normal"> 417</span>
<span class="normal"> 418</span>
<span class="normal"> 419</span>
<span class="normal"> 420</span>
<span class="normal"> 421</span>
<span class="normal"> 422</span>
<span class="normal"> 423</span>
<span class="normal"> 424</span>
<span class="normal"> 425</span>
<span class="normal"> 426</span>
<span class="normal"> 427</span>
<span class="normal"> 428</span>
<span class="normal"> 429</span>
<span class="normal"> 430</span>
<span class="normal"> 431</span>
<span class="normal"> 432</span>
<span class="normal"> 433</span>
<span class="normal"> 434</span>
<span class="normal"> 435</span>
<span class="normal"> 436</span>
<span class="normal"> 437</span>
<span class="normal"> 438</span>
<span class="normal"> 439</span>
<span class="normal"> 440</span>
<span class="normal"> 441</span>
<span class="normal"> 442</span>
<span class="normal"> 443</span>
<span class="normal"> 444</span>
<span class="normal"> 445</span>
<span class="normal"> 446</span>
<span class="normal"> 447</span>
<span class="normal"> 448</span>
<span class="normal"> 449</span>
<span class="normal"> 450</span>
<span class="normal"> 451</span>
<span class="normal"> 452</span>
<span class="normal"> 453</span>
<span class="normal"> 454</span>
<span class="normal"> 455</span>
<span class="normal"> 456</span>
<span class="normal"> 457</span>
<span class="normal"> 458</span>
<span class="normal"> 459</span>
<span class="normal"> 460</span>
<span class="normal"> 461</span>
<span class="normal"> 462</span>
<span class="normal"> 463</span>
<span class="normal"> 464</span>
<span class="normal"> 465</span>
<span class="normal"> 466</span>
<span class="normal"> 467</span>
<span class="normal"> 468</span>
<span class="normal"> 469</span>
<span class="normal"> 470</span>
<span class="normal"> 471</span>
<span class="normal"> 472</span>
<span class="normal"> 473</span>
<span class="normal"> 474</span>
<span class="normal"> 475</span>
<span class="normal"> 476</span>
<span class="normal"> 477</span>
<span class="normal"> 478</span>
<span class="normal"> 479</span>
<span class="normal"> 480</span>
<span class="normal"> 481</span>
<span class="normal"> 482</span>
<span class="normal"> 483</span>
<span class="normal"> 484</span>
<span class="normal"> 485</span>
<span class="normal"> 486</span>
<span class="normal"> 487</span>
<span class="normal"> 488</span>
<span class="normal"> 489</span>
<span class="normal"> 490</span>
<span class="normal"> 491</span>
<span class="normal"> 492</span>
<span class="normal"> 493</span>
<span class="normal"> 494</span>
<span class="normal"> 495</span>
<span class="normal"> 496</span>
<span class="normal"> 497</span>
<span class="normal"> 498</span>
<span class="normal"> 499</span>
<span class="normal"> 500</span>
<span class="normal"> 501</span>
<span class="normal"> 502</span>
<span class="normal"> 503</span>
<span class="normal"> 504</span>
<span class="normal"> 505</span>
<span class="normal"> 506</span>
<span class="normal"> 507</span>
<span class="normal"> 508</span>
<span class="normal"> 509</span>
<span class="normal"> 510</span>
<span class="normal"> 511</span>
<span class="normal"> 512</span>
<span class="normal"> 513</span>
<span class="normal"> 514</span>
<span class="normal"> 515</span>
<span class="normal"> 516</span>
<span class="normal"> 517</span>
<span class="normal"> 518</span>
<span class="normal"> 519</span>
<span class="normal"> 520</span>
<span class="normal"> 521</span>
<span class="normal"> 522</span>
<span class="normal"> 523</span>
<span class="normal"> 524</span>
<span class="normal"> 525</span>
<span class="normal"> 526</span>
<span class="normal"> 527</span>
<span class="normal"> 528</span>
<span class="normal"> 529</span>
<span class="normal"> 530</span>
<span class="normal"> 531</span>
<span class="normal"> 532</span>
<span class="normal"> 533</span>
<span class="normal"> 534</span>
<span class="normal"> 535</span>
<span class="normal"> 536</span>
<span class="normal"> 537</span>
<span class="normal"> 538</span>
<span class="normal"> 539</span>
<span class="normal"> 540</span>
<span class="normal"> 541</span>
<span class="normal"> 542</span>
<span class="normal"> 543</span>
<span class="normal"> 544</span>
<span class="normal"> 545</span>
<span class="normal"> 546</span>
<span class="normal"> 547</span>
<span class="normal"> 548</span>
<span class="normal"> 549</span>
<span class="normal"> 550</span>
<span class="normal"> 551</span>
<span class="normal"> 552</span>
<span class="normal"> 553</span>
<span class="normal"> 554</span>
<span class="normal"> 555</span>
<span class="normal"> 556</span>
<span class="normal"> 557</span>
<span class="normal"> 558</span>
<span class="normal"> 559</span>
<span class="normal"> 560</span>
<span class="normal"> 561</span>
<span class="normal"> 562</span>
<span class="normal"> 563</span>
<span class="normal"> 564</span>
<span class="normal"> 565</span>
<span class="normal"> 566</span>
<span class="normal"> 567</span>
<span class="normal"> 568</span>
<span class="normal"> 569</span>
<span class="normal"> 570</span>
<span class="normal"> 571</span>
<span class="normal"> 572</span>
<span class="normal"> 573</span>
<span class="normal"> 574</span>
<span class="normal"> 575</span>
<span class="normal"> 576</span>
<span class="normal"> 577</span>
<span class="normal"> 578</span>
<span class="normal"> 579</span>
<span class="normal"> 580</span>
<span class="normal"> 581</span>
<span class="normal"> 582</span>
<span class="normal"> 583</span>
<span class="normal"> 584</span>
<span class="normal"> 585</span>
<span class="normal"> 586</span>
<span class="normal"> 587</span>
<span class="normal"> 588</span>
<span class="normal"> 589</span>
<span class="normal"> 590</span>
<span class="normal"> 591</span>
<span class="normal"> 592</span>
<span class="normal"> 593</span>
<span class="normal"> 594</span>
<span class="normal"> 595</span>
<span class="normal"> 596</span>
<span class="normal"> 597</span>
<span class="normal"> 598</span>
<span class="normal"> 599</span>
<span class="normal"> 600</span>
<span class="normal"> 601</span>
<span class="normal"> 602</span>
<span class="normal"> 603</span>
<span class="normal"> 604</span>
<span class="normal"> 605</span>
<span class="normal"> 606</span>
<span class="normal"> 607</span>
<span class="normal"> 608</span>
<span class="normal"> 609</span>
<span class="normal"> 610</span>
<span class="normal"> 611</span>
<span class="normal"> 612</span>
<span class="normal"> 613</span>
<span class="normal"> 614</span>
<span class="normal"> 615</span>
<span class="normal"> 616</span>
<span class="normal"> 617</span>
<span class="normal"> 618</span>
<span class="normal"> 619</span>
<span class="normal"> 620</span>
<span class="normal"> 621</span>
<span class="normal"> 622</span>
<span class="normal"> 623</span>
<span class="normal"> 624</span>
<span class="normal"> 625</span>
<span class="normal"> 626</span>
<span class="normal"> 627</span>
<span class="normal"> 628</span>
<span class="normal"> 629</span>
<span class="normal"> 630</span>
<span class="normal"> 631</span>
<span class="normal"> 632</span>
<span class="normal"> 633</span>
<span class="normal"> 634</span>
<span class="normal"> 635</span>
<span class="normal"> 636</span>
<span class="normal"> 637</span>
<span class="normal"> 638</span>
<span class="normal"> 639</span>
<span class="normal"> 640</span>
<span class="normal"> 641</span>
<span class="normal"> 642</span>
<span class="normal"> 643</span>
<span class="normal"> 644</span>
<span class="normal"> 645</span>
<span class="normal"> 646</span>
<span class="normal"> 647</span>
<span class="normal"> 648</span>
<span class="normal"> 649</span>
<span class="normal"> 650</span>
<span class="normal"> 651</span>
<span class="normal"> 652</span>
<span class="normal"> 653</span>
<span class="normal"> 654</span>
<span class="normal"> 655</span>
<span class="normal"> 656</span>
<span class="normal"> 657</span>
<span class="normal"> 658</span>
<span class="normal"> 659</span>
<span class="normal"> 660</span>
<span class="normal"> 661</span>
<span class="normal"> 662</span>
<span class="normal"> 663</span>
<span class="normal"> 664</span>
<span class="normal"> 665</span>
<span class="normal"> 666</span>
<span class="normal"> 667</span>
<span class="normal"> 668</span>
<span class="normal"> 669</span>
<span class="normal"> 670</span>
<span class="normal"> 671</span>
<span class="normal"> 672</span>
<span class="normal"> 673</span>
<span class="normal"> 674</span>
<span class="normal"> 675</span>
<span class="normal"> 676</span>
<span class="normal"> 677</span>
<span class="normal"> 678</span>
<span class="normal"> 679</span>
<span class="normal"> 680</span>
<span class="normal"> 681</span>
<span class="normal"> 682</span>
<span class="normal"> 683</span>
<span class="normal"> 684</span>
<span class="normal"> 685</span>
<span class="normal"> 686</span>
<span class="normal"> 687</span>
<span class="normal"> 688</span>
<span class="normal"> 689</span>
<span class="normal"> 690</span>
<span class="normal"> 691</span>
<span class="normal"> 692</span>
<span class="normal"> 693</span>
<span class="normal"> 694</span>
<span class="normal"> 695</span>
<span class="normal"> 696</span>
<span class="normal"> 697</span>
<span class="normal"> 698</span>
<span class="normal"> 699</span>
<span class="normal"> 700</span>
<span class="normal"> 701</span>
<span class="normal"> 702</span>
<span class="normal"> 703</span>
<span class="normal"> 704</span>
<span class="normal"> 705</span>
<span class="normal"> 706</span>
<span class="normal"> 707</span>
<span class="normal"> 708</span>
<span class="normal"> 709</span>
<span class="normal"> 710</span>
<span class="normal"> 711</span>
<span class="normal"> 712</span>
<span class="normal"> 713</span>
<span class="normal"> 714</span>
<span class="normal"> 715</span>
<span class="normal"> 716</span>
<span class="normal"> 717</span>
<span class="normal"> 718</span>
<span class="normal"> 719</span>
<span class="normal"> 720</span>
<span class="normal"> 721</span>
<span class="normal"> 722</span>
<span class="normal"> 723</span>
<span class="normal"> 724</span>
<span class="normal"> 725</span>
<span class="normal"> 726</span>
<span class="normal"> 727</span>
<span class="normal"> 728</span>
<span class="normal"> 729</span>
<span class="normal"> 730</span>
<span class="normal"> 731</span>
<span class="normal"> 732</span>
<span class="normal"> 733</span>
<span class="normal"> 734</span>
<span class="normal"> 735</span>
<span class="normal"> 736</span>
<span class="normal"> 737</span>
<span class="normal"> 738</span>
<span class="normal"> 739</span>
<span class="normal"> 740</span>
<span class="normal"> 741</span>
<span class="normal"> 742</span>
<span class="normal"> 743</span>
<span class="normal"> 744</span>
<span class="normal"> 745</span>
<span class="normal"> 746</span>
<span class="normal"> 747</span>
<span class="normal"> 748</span>
<span class="normal"> 749</span>
<span class="normal"> 750</span>
<span class="normal"> 751</span>
<span class="normal"> 752</span>
<span class="normal"> 753</span>
<span class="normal"> 754</span>
<span class="normal"> 755</span>
<span class="normal"> 756</span>
<span class="normal"> 757</span>
<span class="normal"> 758</span>
<span class="normal"> 759</span>
<span class="normal"> 760</span>
<span class="normal"> 761</span>
<span class="normal"> 762</span>
<span class="normal"> 763</span>
<span class="normal"> 764</span>
<span class="normal"> 765</span>
<span class="normal"> 766</span>
<span class="normal"> 767</span>
<span class="normal"> 768</span>
<span class="normal"> 769</span>
<span class="normal"> 770</span>
<span class="normal"> 771</span>
<span class="normal"> 772</span>
<span class="normal"> 773</span>
<span class="normal"> 774</span>
<span class="normal"> 775</span>
<span class="normal"> 776</span>
<span class="normal"> 777</span>
<span class="normal"> 778</span>
<span class="normal"> 779</span>
<span class="normal"> 780</span>
<span class="normal"> 781</span>
<span class="normal"> 782</span>
<span class="normal"> 783</span>
<span class="normal"> 784</span>
<span class="normal"> 785</span>
<span class="normal"> 786</span>
<span class="normal"> 787</span>
<span class="normal"> 788</span>
<span class="normal"> 789</span>
<span class="normal"> 790</span>
<span class="normal"> 791</span>
<span class="normal"> 792</span>
<span class="normal"> 793</span>
<span class="normal"> 794</span>
<span class="normal"> 795</span>
<span class="normal"> 796</span>
<span class="normal"> 797</span>
<span class="normal"> 798</span>
<span class="normal"> 799</span>
<span class="normal"> 800</span>
<span class="normal"> 801</span>
<span class="normal"> 802</span>
<span class="normal"> 803</span>
<span class="normal"> 804</span>
<span class="normal"> 805</span>
<span class="normal"> 806</span>
<span class="normal"> 807</span>
<span class="normal"> 808</span>
<span class="normal"> 809</span>
<span class="normal"> 810</span>
<span class="normal"> 811</span>
<span class="normal"> 812</span>
<span class="normal"> 813</span>
<span class="normal"> 814</span>
<span class="normal"> 815</span>
<span class="normal"> 816</span>
<span class="normal"> 817</span>
<span class="normal"> 818</span>
<span class="normal"> 819</span>
<span class="normal"> 820</span>
<span class="normal"> 821</span>
<span class="normal"> 822</span>
<span class="normal"> 823</span>
<span class="normal"> 824</span>
<span class="normal"> 825</span>
<span class="normal"> 826</span>
<span class="normal"> 827</span>
<span class="normal"> 828</span>
<span class="normal"> 829</span>
<span class="normal"> 830</span>
<span class="normal"> 831</span>
<span class="normal"> 832</span>
<span class="normal"> 833</span>
<span class="normal"> 834</span>
<span class="normal"> 835</span>
<span class="normal"> 836</span>
<span class="normal"> 837</span>
<span class="normal"> 838</span>
<span class="normal"> 839</span>
<span class="normal"> 840</span>
<span class="normal"> 841</span>
<span class="normal"> 842</span>
<span class="normal"> 843</span>
<span class="normal"> 844</span>
<span class="normal"> 845</span>
<span class="normal"> 846</span>
<span class="normal"> 847</span>
<span class="normal"> 848</span>
<span class="normal"> 849</span>
<span class="normal"> 850</span>
<span class="normal"> 851</span>
<span class="normal"> 852</span>
<span class="normal"> 853</span>
<span class="normal"> 854</span>
<span class="normal"> 855</span>
<span class="normal"> 856</span>
<span class="normal"> 857</span>
<span class="normal"> 858</span>
<span class="normal"> 859</span>
<span class="normal"> 860</span>
<span class="normal"> 861</span>
<span class="normal"> 862</span>
<span class="normal"> 863</span>
<span class="normal"> 864</span>
<span class="normal"> 865</span>
<span class="normal"> 866</span>
<span class="normal"> 867</span>
<span class="normal"> 868</span>
<span class="normal"> 869</span>
<span class="normal"> 870</span>
<span class="normal"> 871</span>
<span class="normal"> 872</span>
<span class="normal"> 873</span>
<span class="normal"> 874</span>
<span class="normal"> 875</span>
<span class="normal"> 876</span>
<span class="normal"> 877</span>
<span class="normal"> 878</span>
<span class="normal"> 879</span>
<span class="normal"> 880</span>
<span class="normal"> 881</span>
<span class="normal"> 882</span>
<span class="normal"> 883</span>
<span class="normal"> 884</span>
<span class="normal"> 885</span>
<span class="normal"> 886</span>
<span class="normal"> 887</span>
<span class="normal"> 888</span>
<span class="normal"> 889</span>
<span class="normal"> 890</span>
<span class="normal"> 891</span>
<span class="normal"> 892</span>
<span class="normal"> 893</span>
<span class="normal"> 894</span>
<span class="normal"> 895</span>
<span class="normal"> 896</span>
<span class="normal"> 897</span>
<span class="normal"> 898</span>
<span class="normal"> 899</span>
<span class="normal"> 900</span>
<span class="normal"> 901</span>
<span class="normal"> 902</span>
<span class="normal"> 903</span>
<span class="normal"> 904</span>
<span class="normal"> 905</span>
<span class="normal"> 906</span>
<span class="normal"> 907</span>
<span class="normal"> 908</span>
<span class="normal"> 909</span>
<span class="normal"> 910</span>
<span class="normal"> 911</span>
<span class="normal"> 912</span>
<span class="normal"> 913</span>
<span class="normal"> 914</span>
<span class="normal"> 915</span>
<span class="normal"> 916</span>
<span class="normal"> 917</span>
<span class="normal"> 918</span>
<span class="normal"> 919</span>
<span class="normal"> 920</span>
<span class="normal"> 921</span>
<span class="normal"> 922</span>
<span class="normal"> 923</span>
<span class="normal"> 924</span>
<span class="normal"> 925</span>
<span class="normal"> 926</span>
<span class="normal"> 927</span>
<span class="normal"> 928</span>
<span class="normal"> 929</span>
<span class="normal"> 930</span>
<span class="normal"> 931</span>
<span class="normal"> 932</span>
<span class="normal"> 933</span>
<span class="normal"> 934</span>
<span class="normal"> 935</span>
<span class="normal"> 936</span>
<span class="normal"> 937</span>
<span class="normal"> 938</span>
<span class="normal"> 939</span>
<span class="normal"> 940</span>
<span class="normal"> 941</span>
<span class="normal"> 942</span>
<span class="normal"> 943</span>
<span class="normal"> 944</span>
<span class="normal"> 945</span>
<span class="normal"> 946</span>
<span class="normal"> 947</span>
<span class="normal"> 948</span>
<span class="normal"> 949</span>
<span class="normal"> 950</span>
<span class="normal"> 951</span>
<span class="normal"> 952</span>
<span class="normal"> 953</span>
<span class="normal"> 954</span>
<span class="normal"> 955</span>
<span class="normal"> 956</span>
<span class="normal"> 957</span>
<span class="normal"> 958</span>
<span class="normal"> 959</span>
<span class="normal"> 960</span>
<span class="normal"> 961</span>
<span class="normal"> 962</span>
<span class="normal"> 963</span>
<span class="normal"> 964</span>
<span class="normal"> 965</span>
<span class="normal"> 966</span>
<span class="normal"> 967</span>
<span class="normal"> 968</span>
<span class="normal"> 969</span>
<span class="normal"> 970</span>
<span class="normal"> 971</span>
<span class="normal"> 972</span>
<span class="normal"> 973</span>
<span class="normal"> 974</span>
<span class="normal"> 975</span>
<span class="normal"> 976</span>
<span class="normal"> 977</span>
<span class="normal"> 978</span>
<span class="normal"> 979</span>
<span class="normal"> 980</span>
<span class="normal"> 981</span>
<span class="normal"> 982</span>
<span class="normal"> 983</span>
<span class="normal"> 984</span>
<span class="normal"> 985</span>
<span class="normal"> 986</span>
<span class="normal"> 987</span>
<span class="normal"> 988</span>
<span class="normal"> 989</span>
<span class="normal"> 990</span>
<span class="normal"> 991</span>
<span class="normal"> 992</span>
<span class="normal"> 993</span>
<span class="normal"> 994</span>
<span class="normal"> 995</span>
<span class="normal"> 996</span>
<span class="normal"> 997</span>
<span class="normal"> 998</span>
<span class="normal"> 999</span>
<span class="normal">1000</span>
<span class="normal">1001</span>
<span class="normal">1002</span>
<span class="normal">1003</span>
<span class="normal">1004</span>
<span class="normal">1005</span>
<span class="normal">1006</span>
<span class="normal">1007</span>
<span class="normal">1008</span>
<span class="normal">1009</span>
<span class="normal">1010</span>
<span class="normal">1011</span>
<span class="normal">1012</span>
<span class="normal">1013</span>
<span class="normal">1014</span>
<span class="normal">1015</span>
<span class="normal">1016</span>
<span class="normal">1017</span>
<span class="normal">1018</span>
<span class="normal">1019</span>
<span class="normal">1020</span>
<span class="normal">1021</span>
<span class="normal">1022</span>
<span class="normal">1023</span>
<span class="normal">1024</span>
<span class="normal">1025</span>
<span class="normal">1026</span>
<span class="normal">1027</span>
<span class="normal">1028</span>
<span class="normal">1029</span>
<span class="normal">1030</span>
<span class="normal">1031</span>
<span class="normal">1032</span>
<span class="normal">1033</span>
<span class="normal">1034</span>
<span class="normal">1035</span>
<span class="normal">1036</span>
<span class="normal">1037</span>
<span class="normal">1038</span>
<span class="normal">1039</span>
<span class="normal">1040</span>
<span class="normal">1041</span>
<span class="normal">1042</span>
<span class="normal">1043</span>
<span class="normal">1044</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">Device</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
    <span class="n">device_array</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
    <span class="n">buffer_spec</span><span class="p">:</span> <span class="n">BufferSpec</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="n">BufferSpec</span><span class="p">)</span>

    <span class="k">class</span> <span class="nc">Config</span><span class="p">:</span>
        <span class="n">arbitrary_types_allowed</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">shape</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">device_array</span><span class="o">.</span><span class="n">shape</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">device_array</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">buffer_spec</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">BufferSpec</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Represents the planar geometry of a photonic device design that will have its</span>
<span class="sd">        nanofabrication outcome predicted and/or corrected.</span>

<span class="sd">        This class is designed to encapsulate the geometric representation of a photonic</span>
<span class="sd">        device, facilitating operations such as padding, normalization, binarization,</span>
<span class="sd">        ternarization, trimming, and blurring. These operations are useful for preparing</span>
<span class="sd">        the device design for prediction or correction. Additionally, the class provides</span>
<span class="sd">        methods for exporting the device representation to various formats, including</span>
<span class="sd">        ndarray, image files, and GDSII files, supporting a range of analysis and</span>
<span class="sd">        fabrication workflows.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        device_array : np.ndarray</span>
<span class="sd">            A 2D array representing the planar geometry of the device. This array</span>
<span class="sd">            undergoes various transformations to predict or correct the nanofabrication</span>
<span class="sd">            process.</span>
<span class="sd">        buffer_spec : BufferSpec, optional</span>
<span class="sd">            Defines the parameters for adding a buffer zone around the device geometry.</span>
<span class="sd">            This buffer zone is needed for providing surrounding context for prediction</span>
<span class="sd">            or correction and for ensuring seamless integration with the surrounding</span>
<span class="sd">            circuitry. By default, a generous padding is applied to accommodate isolated</span>
<span class="sd">            structures.</span>

<span class="sd">        Attributes</span>
<span class="sd">        ----------</span>
<span class="sd">        shape : tuple[int, int]</span>
<span class="sd">            The shape of the device array.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            If the provided `device_array` is not a numpy ndarray or is not a 2D array,</span>
<span class="sd">            indicating an invalid device geometry.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="n">device_array</span><span class="o">=</span><span class="n">device_array</span><span class="p">,</span> <span class="n">buffer_spec</span><span class="o">=</span><span class="n">buffer_spec</span> <span class="ow">or</span> <span class="n">BufferSpec</span><span class="p">()</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_initial_processing</span><span class="p">()</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_initial_processing</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">buffer_thickness</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">buffer_spec</span><span class="o">.</span><span class="n">thickness</span>
        <span class="n">buffer_mode</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">buffer_spec</span><span class="o">.</span><span class="n">mode</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">device_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pad</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">device_array</span><span class="p">,</span>
            <span class="n">pad_width</span><span class="o">=</span><span class="p">((</span><span class="n">buffer_thickness</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)),</span>
            <span class="n">mode</span><span class="o">=</span><span class="n">buffer_mode</span><span class="p">[</span><span class="s2">&quot;top&quot;</span><span class="p">],</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">device_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pad</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">device_array</span><span class="p">,</span>
            <span class="n">pad_width</span><span class="o">=</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="n">buffer_thickness</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)),</span>
            <span class="n">mode</span><span class="o">=</span><span class="n">buffer_mode</span><span class="p">[</span><span class="s2">&quot;bottom&quot;</span><span class="p">],</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">device_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pad</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">device_array</span><span class="p">,</span>
            <span class="n">pad_width</span><span class="o">=</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="n">buffer_thickness</span><span class="p">,</span> <span class="mi">0</span><span class="p">)),</span>
            <span class="n">mode</span><span class="o">=</span><span class="n">buffer_mode</span><span class="p">[</span><span class="s2">&quot;left&quot;</span><span class="p">],</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">device_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pad</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">device_array</span><span class="p">,</span>
            <span class="n">pad_width</span><span class="o">=</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">buffer_thickness</span><span class="p">)),</span>
            <span class="n">mode</span><span class="o">=</span><span class="n">buffer_mode</span><span class="p">[</span><span class="s2">&quot;right&quot;</span><span class="p">],</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">device_array</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">device_array</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>

    <span class="nd">@root_validator</span><span class="p">(</span><span class="n">pre</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">check_device_array</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">values</span><span class="p">):</span>
        <span class="n">device_array</span> <span class="o">=</span> <span class="n">values</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;device_array&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">device_array</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;device_array must be a numpy ndarray.&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">device_array</span><span class="o">.</span><span class="n">ndim</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;device_array must be a 2D array.&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">values</span>

    <span class="k">def</span> <span class="nf">is_binary</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Check if the device geometry is binary.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        bool</span>
<span class="sd">            True if the device geometry is binary, False otherwise.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">unique_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">device_array</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">array_equal</span><span class="p">(</span><span class="n">unique_values</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
            <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">array_equal</span><span class="p">(</span><span class="n">unique_values</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
            <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">array_equal</span><span class="p">(</span><span class="n">unique_values</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">array_equal</span><span class="p">(</span><span class="n">unique_values</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">_encode_array</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">array</span><span class="p">):</span>
        <span class="n">array_shape</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s2">&quot;&gt;II&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">array</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">array</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
        <span class="n">serialized_array</span> <span class="o">=</span> <span class="n">array_shape</span> <span class="o">+</span> <span class="n">array</span><span class="o">.</span><span class="n">tobytes</span><span class="p">()</span>
        <span class="n">encoded_array</span> <span class="o">=</span> <span class="n">base64</span><span class="o">.</span><span class="n">b64encode</span><span class="p">(</span><span class="n">serialized_array</span><span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">encoded_array</span>

    <span class="k">def</span> <span class="nf">_decode_array</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">encoded_array</span><span class="p">):</span>
        <span class="n">serialized_array</span> <span class="o">=</span> <span class="n">base64</span><span class="o">.</span><span class="n">b64decode</span><span class="p">(</span><span class="n">encoded_array</span><span class="p">)</span>
        <span class="n">array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">frombuffer</span><span class="p">(</span><span class="n">serialized_array</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
        <span class="n">array</span><span class="o">.</span><span class="n">shape</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="s2">&quot;&gt;II&quot;</span><span class="p">,</span> <span class="n">serialized_array</span><span class="p">[:</span><span class="mi">8</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">array</span>

    <span class="k">def</span> <span class="nf">_predict</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">model_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">model_tags</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
        <span class="n">model_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">binarize</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Device&quot;</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_binary</span><span class="p">():</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                <span class="s2">&quot;The device is not binary. Prediction accuracy will be affected.&quot;</span><span class="p">,</span>
                <span class="ne">UserWarning</span><span class="p">,</span>
                <span class="n">stacklevel</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="n">function_url</span> <span class="o">=</span> <span class="s2">&quot;https://prefab-photonics--predict-v1.modal.run&quot;</span>

        <span class="n">predict_data</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;device_array&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_encode_array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">device_array</span><span class="p">),</span>
            <span class="s2">&quot;model_name&quot;</span><span class="p">:</span> <span class="n">model_name</span><span class="p">,</span>
            <span class="s2">&quot;model_tags&quot;</span><span class="p">:</span> <span class="n">model_tags</span><span class="p">,</span>
            <span class="s2">&quot;model_type&quot;</span><span class="p">:</span> <span class="n">model_type</span><span class="p">,</span>
            <span class="s2">&quot;binary&quot;</span><span class="p">:</span> <span class="n">binarize</span><span class="p">,</span>
        <span class="p">}</span>

        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s2">&quot;~/.prefab.toml&quot;</span><span class="p">))</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
            <span class="n">content</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">content</span><span class="p">:</span>
                <span class="k">if</span> <span class="s2">&quot;access_token&quot;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
                    <span class="n">access_token</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;=&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
                <span class="k">if</span> <span class="s2">&quot;refresh_token&quot;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
                    <span class="n">refresh_token</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;=&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
                    <span class="k">break</span>
        <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;Authorization&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;Bearer </span><span class="si">{</span><span class="n">access_token</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="s2">&quot;X-Refresh-Token&quot;</span><span class="p">:</span> <span class="n">refresh_token</span><span class="p">,</span>
        <span class="p">}</span>

        <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="n">function_url</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="n">predict_data</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">!=</span> <span class="mi">200</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">response_data</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
            <span class="k">if</span> <span class="s2">&quot;error&quot;</span> <span class="ow">in</span> <span class="n">response_data</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">response_data</span><span class="p">[</span><span class="s2">&quot;error&quot;</span><span class="p">])</span>
            <span class="k">if</span> <span class="s2">&quot;prediction_array&quot;</span> <span class="ow">in</span> <span class="n">response_data</span><span class="p">:</span>
                <span class="n">prediction_array</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_decode_array</span><span class="p">(</span><span class="n">response_data</span><span class="p">[</span><span class="s2">&quot;prediction_array&quot;</span><span class="p">])</span>
                <span class="k">if</span> <span class="n">binarize</span><span class="p">:</span>
                    <span class="n">prediction_array</span> <span class="o">=</span> <span class="n">geometry</span><span class="o">.</span><span class="n">binarize_hard</span><span class="p">(</span><span class="n">prediction_array</span><span class="p">)</span>
            <span class="k">if</span> <span class="s2">&quot;new_refresh_token&quot;</span> <span class="ow">in</span> <span class="n">response_data</span><span class="p">:</span>
                <span class="n">prefab_file_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s2">&quot;~/.prefab.toml&quot;</span><span class="p">)</span>
                <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">prefab_file_path</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">toml_file</span><span class="p">:</span>
                    <span class="n">toml</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span>
                        <span class="p">{</span>
                            <span class="s2">&quot;access_token&quot;</span><span class="p">:</span> <span class="n">response_data</span><span class="p">[</span><span class="s2">&quot;new_access_token&quot;</span><span class="p">],</span>
                            <span class="s2">&quot;refresh_token&quot;</span><span class="p">:</span> <span class="n">response_data</span><span class="p">[</span><span class="s2">&quot;new_refresh_token&quot;</span><span class="p">],</span>
                        <span class="p">},</span>
                        <span class="n">toml_file</span><span class="p">,</span>
                    <span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_copy</span><span class="p">(</span><span class="n">update</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;device_array&quot;</span><span class="p">:</span> <span class="n">prediction_array</span><span class="p">})</span>

    <span class="k">def</span> <span class="nf">predict</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">model_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">model_tags</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
        <span class="n">binarize</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Device&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Predict the nanofabrication outcome of the device using a specified model.</span>

<span class="sd">        This method sends the device geometry to a serverless prediction service, which</span>
<span class="sd">        uses a specified machine learning model to predict the outcome of the</span>
<span class="sd">        nanofabrication process.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        model_name : str</span>
<span class="sd">            The name of the model to use for prediction.</span>
<span class="sd">        model_tags : list[str]</span>
<span class="sd">            A list of tags associated with the model. These tags can be used to specify</span>
<span class="sd">            model versions or configurations.</span>
<span class="sd">        binarize : bool, optional</span>
<span class="sd">            If True, the predicted device geometry will be binarized using a threshold</span>
<span class="sd">            method. This is useful for converting probabilistic predictions into binary</span>
<span class="sd">            geometries. Defaults to False.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Device</span>
<span class="sd">            A new instance of the Device class with the predicted geometry.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            If the prediction service returns an error or if the response from the</span>
<span class="sd">            service cannot be processed correctly.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_predict</span><span class="p">(</span>
            <span class="n">model_name</span><span class="o">=</span><span class="n">model_name</span><span class="p">,</span>
            <span class="n">model_tags</span><span class="o">=</span><span class="n">model_tags</span><span class="p">,</span>
            <span class="n">model_type</span><span class="o">=</span><span class="s2">&quot;p&quot;</span><span class="p">,</span>
            <span class="n">binarize</span><span class="o">=</span><span class="n">binarize</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">correct</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">model_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">model_tags</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
        <span class="n">binarize</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Device&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Correct the nanofabrication outcome of the device using a specified model.</span>

<span class="sd">        This method sends the device geometry to a serverless correction service, which</span>
<span class="sd">        uses a specified machine learning model to correct the outcome of the</span>
<span class="sd">        nanofabrication process. The correction aims to adjust the device geometry to</span>
<span class="sd">        compensate for known fabrication errors and improve the accuracy of the final</span>
<span class="sd">        device structure.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        model_name : str</span>
<span class="sd">            The name of the model to use for correction.</span>
<span class="sd">        model_tags : list[str]</span>
<span class="sd">            A list of tags associated with the model. These tags can be used to specify</span>
<span class="sd">            model versions or configurations.</span>
<span class="sd">        binarize : bool, optional</span>
<span class="sd">            If True, the corrected device geometry will be binarized using a threshold</span>
<span class="sd">            method. This is useful for converting probabilistic corrections into binary</span>
<span class="sd">            geometries. Defaults to True.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Device</span>
<span class="sd">            A new instance of the Device class with the corrected geometry.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            If the correction service returns an error or if the response from the</span>
<span class="sd">            service cannot be processed correctly.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_predict</span><span class="p">(</span>
            <span class="n">model_name</span><span class="o">=</span><span class="n">model_name</span><span class="p">,</span>
            <span class="n">model_tags</span><span class="o">=</span><span class="n">model_tags</span><span class="p">,</span>
            <span class="n">model_type</span><span class="o">=</span><span class="s2">&quot;c&quot;</span><span class="p">,</span>
            <span class="n">binarize</span><span class="o">=</span><span class="n">binarize</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">semulate</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">model_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">model_tags</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Device&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Simulate the appearance of the device as if viewed under a Scanning Electron</span>
<span class="sd">        Microscope (SEM).</span>

<span class="sd">        This method applies a specified machine learning model to transform the device</span>
<span class="sd">        geometry into a style that resembles an SEM image. This can be useful for</span>
<span class="sd">        visualizing how the device might appear under an SEM, which is often used for</span>
<span class="sd">        inspecting the surface and composition of materials at high magnification.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        model_name : str</span>
<span class="sd">            The name of the model to use for correction.</span>
<span class="sd">        model_tags : list[str]</span>
<span class="sd">            A list of tags associated with the model. These tags can be used to specify</span>
<span class="sd">            model versions or configurations.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Device</span>
<span class="sd">            A new instance of the Device class with its geometry transformed to simulate</span>
<span class="sd">            an SEM image style.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_predict</span><span class="p">(</span>
            <span class="n">model_name</span><span class="o">=</span><span class="n">model_name</span><span class="p">,</span>
            <span class="n">model_tags</span><span class="o">=</span><span class="n">model_tags</span><span class="p">,</span>
            <span class="n">model_type</span><span class="o">=</span><span class="s2">&quot;s&quot;</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">to_ndarray</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Converts the device geometry to a numpy ndarray.</span>

<span class="sd">        This method applies the buffer specifications to crop the device array if</span>
<span class="sd">        necessary, based on the buffer mode (&#39;edge&#39; or &#39;constant&#39;). It then returns the</span>
<span class="sd">        resulting numpy ndarray representing the device geometry.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        np.ndarray</span>
<span class="sd">            The numpy ndarray representation of the device geometry, with any applied</span>
<span class="sd">            buffer cropping.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">device_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">device_array</span><span class="p">)</span>
        <span class="n">buffer_thickness</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">buffer_spec</span><span class="o">.</span><span class="n">thickness</span>
        <span class="n">buffer_mode</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">buffer_spec</span><span class="o">.</span><span class="n">mode</span>

        <span class="n">crop_top</span> <span class="o">=</span> <span class="n">buffer_thickness</span> <span class="k">if</span> <span class="n">buffer_mode</span><span class="p">[</span><span class="s2">&quot;top&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;edge&quot;</span> <span class="k">else</span> <span class="mi">0</span>
        <span class="n">crop_bottom</span> <span class="o">=</span> <span class="n">buffer_thickness</span> <span class="k">if</span> <span class="n">buffer_mode</span><span class="p">[</span><span class="s2">&quot;bottom&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;edge&quot;</span> <span class="k">else</span> <span class="mi">0</span>
        <span class="n">crop_left</span> <span class="o">=</span> <span class="n">buffer_thickness</span> <span class="k">if</span> <span class="n">buffer_mode</span><span class="p">[</span><span class="s2">&quot;left&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;edge&quot;</span> <span class="k">else</span> <span class="mi">0</span>
        <span class="n">crop_right</span> <span class="o">=</span> <span class="n">buffer_thickness</span> <span class="k">if</span> <span class="n">buffer_mode</span><span class="p">[</span><span class="s2">&quot;right&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;edge&quot;</span> <span class="k">else</span> <span class="mi">0</span>

        <span class="n">ndarray</span> <span class="o">=</span> <span class="n">device_array</span><span class="p">[</span>
            <span class="n">crop_top</span> <span class="p">:</span> <span class="n">device_array</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">crop_bottom</span><span class="p">,</span>
            <span class="n">crop_left</span> <span class="p">:</span> <span class="n">device_array</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">crop_right</span><span class="p">,</span>
        <span class="p">]</span>
        <span class="k">return</span> <span class="n">ndarray</span>

    <span class="k">def</span> <span class="nf">to_img</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">img_path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;prefab_device.png&quot;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Exports the device geometry as an image file.</span>

<span class="sd">        This method converts the device geometry to a numpy ndarray using `to_ndarray`,</span>
<span class="sd">        scales the values to the range [0, 255] for image representation, and saves the</span>
<span class="sd">        result as an image file.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        img_path : str, optional</span>
<span class="sd">            The path where the image file will be saved. If not specified, the image is</span>
<span class="sd">            saved as &quot;prefab_device.png&quot; in the current directory.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">cv2</span><span class="o">.</span><span class="n">imwrite</span><span class="p">(</span><span class="n">img_path</span><span class="p">,</span> <span class="mi">255</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_ndarray</span><span class="p">())</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Saved Device to &#39;</span><span class="si">{</span><span class="n">img_path</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">to_gds</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">gds_path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;prefab_device.gds&quot;</span><span class="p">,</span>
        <span class="n">cell_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;prefab_device&quot;</span><span class="p">,</span>
        <span class="n">gds_layer</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
        <span class="n">contour_approx_mode</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Exports the device geometry as a GDSII file.</span>

<span class="sd">        This method converts the device geometry into a format suitable for GDSII files.</span>
<span class="sd">        The conversion involves contour approximation to simplify the geometry while</span>
<span class="sd">        preserving essential features.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        gds_path : str, optional</span>
<span class="sd">            The path where the GDSII file will be saved. If not specified, the file is</span>
<span class="sd">            saved as &quot;prefab_device.gds&quot; in the current directory.</span>
<span class="sd">        cell_name : str, optional</span>
<span class="sd">            The name of the cell within the GDSII file. If not specified, defaults to</span>
<span class="sd">            &quot;prefab_device&quot;.</span>
<span class="sd">        gds_layer : tuple[int, int], optional</span>
<span class="sd">            The layer and datatype to use within the GDSII file. Defaults to (1, 0).</span>
<span class="sd">        contour_approx_mode : int, optional</span>
<span class="sd">            The mode of contour approximation used during the conversion. Defaults to 2,</span>
<span class="sd">            which corresponds to `cv2.CHAIN_APPROX_SIMPLE`, a method that compresses</span>
<span class="sd">            horizontal, vertical, and diagonal segments and leaves only their endpoints.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">gdstk_cell</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_device_to_gdstk</span><span class="p">(</span>
            <span class="n">cell_name</span><span class="o">=</span><span class="n">cell_name</span><span class="p">,</span>
            <span class="n">gds_layer</span><span class="o">=</span><span class="n">gds_layer</span><span class="p">,</span>
            <span class="n">contour_approx_mode</span><span class="o">=</span><span class="n">contour_approx_mode</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Saving GDS to &#39;</span><span class="si">{</span><span class="n">gds_path</span><span class="si">}</span><span class="s2">&#39;...&quot;</span><span class="p">)</span>
        <span class="n">gdstk_library</span> <span class="o">=</span> <span class="n">gdstk</span><span class="o">.</span><span class="n">Library</span><span class="p">()</span>
        <span class="n">gdstk_library</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">gdstk_cell</span><span class="p">)</span>
        <span class="n">gdstk_library</span><span class="o">.</span><span class="n">write_gds</span><span class="p">(</span><span class="n">outfile</span><span class="o">=</span><span class="n">gds_path</span><span class="p">,</span> <span class="n">max_points</span><span class="o">=</span><span class="mi">8190</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">to_gdstk</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">cell_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;prefab_device&quot;</span><span class="p">,</span>
        <span class="n">gds_layer</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
        <span class="n">contour_approx_mode</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Converts the device geometry to a GDSTK cell object.</span>

<span class="sd">        This method prepares the device geometry for GDSII file export by converting it</span>
<span class="sd">        into a GDSTK cell object. GDSTK is a Python module for creating and manipulating</span>
<span class="sd">        GDSII layout files. The conversion involves contour approximation to simplify</span>
<span class="sd">        the geometry while preserving essential features.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        cell_name : str, optional</span>
<span class="sd">            The name of the cell to be created. Defaults to &quot;prefab_device&quot;.</span>
<span class="sd">        gds_layer : tuple[int, int], optional</span>
<span class="sd">            The layer and datatype to use within the GDSTK cell. Defaults to (1, 0).</span>
<span class="sd">        contour_approx_mode : int, optional</span>
<span class="sd">            The mode of contour approximation used during the conversion. Defaults to 2,</span>
<span class="sd">            which corresponds to `cv2.CHAIN_APPROX_SIMPLE`, a method that compresses</span>
<span class="sd">            horizontal, vertical, and diagonal segments and leaves only their endpoints.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        gdstk.Cell</span>
<span class="sd">            The GDSTK cell object representing the device geometry.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Creating cell &#39;</span><span class="si">{</span><span class="n">cell_name</span><span class="si">}</span><span class="s2">&#39;...&quot;</span><span class="p">)</span>
        <span class="n">gdstk_cell</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_device_to_gdstk</span><span class="p">(</span>
            <span class="n">cell_name</span><span class="o">=</span><span class="n">cell_name</span><span class="p">,</span>
            <span class="n">gds_layer</span><span class="o">=</span><span class="n">gds_layer</span><span class="p">,</span>
            <span class="n">contour_approx_mode</span><span class="o">=</span><span class="n">contour_approx_mode</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">gdstk_cell</span>

    <span class="k">def</span> <span class="nf">_device_to_gdstk</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">cell_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">gds_layer</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span>
        <span class="n">contour_approx_mode</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">gdstk</span><span class="o">.</span><span class="n">Cell</span><span class="p">:</span>
        <span class="n">approx_mode_mapping</span> <span class="o">=</span> <span class="p">{</span>
            <span class="mi">1</span><span class="p">:</span> <span class="n">cv2</span><span class="o">.</span><span class="n">CHAIN_APPROX_NONE</span><span class="p">,</span>
            <span class="mi">2</span><span class="p">:</span> <span class="n">cv2</span><span class="o">.</span><span class="n">CHAIN_APPROX_SIMPLE</span><span class="p">,</span>
            <span class="mi">3</span><span class="p">:</span> <span class="n">cv2</span><span class="o">.</span><span class="n">CHAIN_APPROX_TC89_L1</span><span class="p">,</span>
            <span class="mi">4</span><span class="p">:</span> <span class="n">cv2</span><span class="o">.</span><span class="n">CHAIN_APPROX_TC89_KCOS</span><span class="p">,</span>
        <span class="p">}</span>

        <span class="n">contours</span><span class="p">,</span> <span class="n">hierarchy</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">findContours</span><span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">flipud</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">to_ndarray</span><span class="p">())</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">),</span>
            <span class="n">cv2</span><span class="o">.</span><span class="n">RETR_TREE</span><span class="p">,</span>
            <span class="n">approx_mode_mapping</span><span class="p">[</span><span class="n">contour_approx_mode</span><span class="p">],</span>
        <span class="p">)</span>

        <span class="n">hierarchy_polygons</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">contour</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">contours</span><span class="p">):</span>
            <span class="n">level</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">current_idx</span> <span class="o">=</span> <span class="n">idx</span>
            <span class="k">while</span> <span class="n">hierarchy</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">current_idx</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                <span class="n">level</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="n">current_idx</span> <span class="o">=</span> <span class="n">hierarchy</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">current_idx</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span>

            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">contour</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
                <span class="n">contour</span> <span class="o">=</span> <span class="n">contour</span> <span class="o">/</span> <span class="mi">1000</span>
                <span class="n">points</span> <span class="o">=</span> <span class="p">[</span><span class="nb">tuple</span><span class="p">(</span><span class="n">point</span><span class="p">)</span> <span class="k">for</span> <span class="n">point</span> <span class="ow">in</span> <span class="n">contour</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span><span class="o">.</span><span class="n">tolist</span><span class="p">()]</span>
                <span class="k">if</span> <span class="n">level</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">hierarchy_polygons</span><span class="p">:</span>
                    <span class="n">hierarchy_polygons</span><span class="p">[</span><span class="n">level</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="n">hierarchy_polygons</span><span class="p">[</span><span class="n">level</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">points</span><span class="p">)</span>

        <span class="n">cell</span> <span class="o">=</span> <span class="n">gdstk</span><span class="o">.</span><span class="n">Cell</span><span class="p">(</span><span class="n">cell_name</span><span class="p">)</span>
        <span class="n">processed_polygons</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">level</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">hierarchy_polygons</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
            <span class="n">operation</span> <span class="o">=</span> <span class="s2">&quot;or&quot;</span> <span class="k">if</span> <span class="n">level</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="s2">&quot;xor&quot;</span>
            <span class="n">polygons_to_process</span> <span class="o">=</span> <span class="n">hierarchy_polygons</span><span class="p">[</span><span class="n">level</span><span class="p">]</span>

            <span class="k">if</span> <span class="n">polygons_to_process</span><span class="p">:</span>
                <span class="n">processed_polygons</span> <span class="o">=</span> <span class="n">gdstk</span><span class="o">.</span><span class="n">boolean</span><span class="p">(</span>
                    <span class="n">polygons_to_process</span><span class="p">,</span>
                    <span class="n">processed_polygons</span><span class="p">,</span>
                    <span class="n">operation</span><span class="p">,</span>
                    <span class="n">layer</span><span class="o">=</span><span class="n">gds_layer</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                    <span class="n">datatype</span><span class="o">=</span><span class="n">gds_layer</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                <span class="p">)</span>
        <span class="k">for</span> <span class="n">polygon</span> <span class="ow">in</span> <span class="n">processed_polygons</span><span class="p">:</span>
            <span class="n">cell</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">polygon</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">cell</span>

    <span class="k">def</span> <span class="nf">_plot_base</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">plot_array</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
        <span class="n">show_buffer</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
        <span class="n">bounds</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]],</span>
        <span class="n">ax</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Axes</span><span class="p">],</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Axes</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">_</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;y (nm)&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;x (nm)&quot;</span><span class="p">)</span>

        <span class="n">min_x</span><span class="p">,</span> <span class="n">min_y</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="k">if</span> <span class="n">bounds</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">bounds</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">max_x</span><span class="p">,</span> <span class="n">max_y</span> <span class="o">=</span> <span class="n">plot_array</span><span class="o">.</span><span class="n">shape</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="k">if</span> <span class="n">bounds</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">bounds</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">min_x</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">min_x</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">min_y</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">min_y</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">max_x</span> <span class="o">=</span> <span class="s2">&quot;end&quot;</span> <span class="k">if</span> <span class="n">max_x</span> <span class="o">==</span> <span class="s2">&quot;end&quot;</span> <span class="k">else</span> <span class="nb">min</span><span class="p">(</span><span class="n">max_x</span><span class="p">,</span> <span class="n">plot_array</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">max_y</span> <span class="o">=</span> <span class="s2">&quot;end&quot;</span> <span class="k">if</span> <span class="n">max_y</span> <span class="o">==</span> <span class="s2">&quot;end&quot;</span> <span class="k">else</span> <span class="nb">min</span><span class="p">(</span><span class="n">max_y</span><span class="p">,</span> <span class="n">plot_array</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">max_x</span> <span class="o">=</span> <span class="n">plot_array</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">if</span> <span class="n">max_x</span> <span class="o">==</span> <span class="s2">&quot;end&quot;</span> <span class="k">else</span> <span class="n">max_x</span>
        <span class="n">max_y</span> <span class="o">=</span> <span class="n">plot_array</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="n">max_y</span> <span class="o">==</span> <span class="s2">&quot;end&quot;</span> <span class="k">else</span> <span class="n">max_y</span>
        <span class="n">plot_array</span> <span class="o">=</span> <span class="n">plot_array</span><span class="p">[</span>
            <span class="n">plot_array</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">max_y</span> <span class="p">:</span> <span class="n">plot_array</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">min_y</span><span class="p">,</span>
            <span class="n">min_x</span><span class="p">:</span><span class="n">max_x</span><span class="p">,</span>
        <span class="p">]</span>
        <span class="n">extent</span> <span class="o">=</span> <span class="p">[</span><span class="n">min_x</span><span class="p">,</span> <span class="n">max_x</span><span class="p">,</span> <span class="n">min_y</span><span class="p">,</span> <span class="n">max_y</span><span class="p">]</span>

        <span class="n">max_size</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
        <span class="n">scale_x</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">max_size</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="n">plot_array</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">scale_y</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">max_size</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="n">plot_array</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">fx</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">scale_x</span><span class="p">,</span> <span class="n">scale_y</span><span class="p">)</span>
        <span class="n">fy</span> <span class="o">=</span> <span class="n">fx</span>
        <span class="n">plot_array</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">resize</span><span class="p">(</span>
            <span class="n">plot_array</span><span class="p">,</span>
            <span class="n">dsize</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
            <span class="n">fx</span><span class="o">=</span><span class="n">fx</span><span class="p">,</span>
            <span class="n">fy</span><span class="o">=</span><span class="n">fy</span><span class="p">,</span>
            <span class="n">interpolation</span><span class="o">=</span><span class="n">cv2</span><span class="o">.</span><span class="n">INTER_AREA</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">mappable</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span>
            <span class="n">plot_array</span><span class="p">,</span>
            <span class="n">extent</span><span class="o">=</span><span class="n">extent</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="n">show_buffer</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_add_buffer_visualization</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">mappable</span><span class="p">,</span> <span class="n">ax</span>

    <span class="k">def</span> <span class="nf">plot</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">show_buffer</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">bounds</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">ax</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Axes</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Axes</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Visualizes the device geometry, optionally including buffer zones.</span>

<span class="sd">        This method allows for the visualization of the device geometry with an option</span>
<span class="sd">        to include buffer zones. It supports zooming into a specific area of the device.</span>
<span class="sd">        The visualization can be customized with various matplotlib parameters and can</span>
<span class="sd">        be drawn on an existing matplotlib Axes object or create a new one if none is</span>
<span class="sd">        provided.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        show_buffer : bool, optional</span>
<span class="sd">            If True, visualizes the buffer zones around the device to provide spatial</span>
<span class="sd">            context. Defaults to True.</span>
<span class="sd">        bounds : Optional[tuple[tuple[int, int], tuple[int, int]]], optional</span>
<span class="sd">            Specifies the bounds for zooming into the device geometry, formatted as</span>
<span class="sd">            ((min_x, min_y), (max_x, max_y)). If &#39;max_x&#39; or &#39;max_y&#39; is set to &quot;end&quot;, it</span>
<span class="sd">            will be replaced with the corresponding dimension size of the device array.</span>
<span class="sd">            If None, the entire device geometry is visualized.</span>
<span class="sd">        ax : Optional[Axes], optional</span>
<span class="sd">            An existing matplotlib Axes object to draw the device geometry on. If</span>
<span class="sd">            None, a new figure and axes will be created. Defaults to None.</span>
<span class="sd">        **kwargs</span>
<span class="sd">            Additional matplotlib parameters for plot customization.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Axes</span>
<span class="sd">            The matplotlib Axes object containing the plot. This object can be used for</span>
<span class="sd">            further plot customization or saving the plot after the method returns.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">_</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_plot_base</span><span class="p">(</span>
            <span class="n">plot_array</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">device_array</span><span class="p">,</span>
            <span class="n">show_buffer</span><span class="o">=</span><span class="n">show_buffer</span><span class="p">,</span>
            <span class="n">bounds</span><span class="o">=</span><span class="n">bounds</span><span class="p">,</span>
            <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">ax</span>

    <span class="k">def</span> <span class="nf">plot_contour</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">linewidth</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="c1"># label: Optional[str] = &quot;Device contour&quot;,</span>
        <span class="n">show_buffer</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">bounds</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">ax</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Axes</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Visualizes the contour of the device along with optional buffer zones.</span>

<span class="sd">        This method plots the contour of the device geometry, emphasizing the edges and</span>
<span class="sd">        boundaries of the device. The contour plot can be customized with various</span>
<span class="sd">        matplotlib parameters, including line width and color. The plot can be drawn on</span>
<span class="sd">        an existing matplotlib Axes object or create a new one if none is provided.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        linewidth : Optional[int], optional</span>
<span class="sd">            The width of the contour lines. If None, the linewidth is automatically</span>
<span class="sd">            determined based on the size of the device array. Defaults to None.</span>
<span class="sd">        show_buffer : bool, optional</span>
<span class="sd">            If True, the buffer zones around the device will be visualized. By default,</span>
<span class="sd">            it is set to True.</span>
<span class="sd">        bounds : Optional[tuple[tuple[int, int], tuple[int, int]]], optional</span>
<span class="sd">            Specifies the bounds for zooming into the device geometry, formatted as</span>
<span class="sd">            ((min_x, min_y), (max_x, max_y)). If &#39;max_x&#39; or &#39;max_y&#39; is set to &quot;end&quot;, it</span>
<span class="sd">            will be replaced with the corresponding dimension size of the device array.</span>
<span class="sd">            If None, the entire device geometry is visualized.</span>
<span class="sd">        ax : Optional[Axes], optional</span>
<span class="sd">            An existing matplotlib Axes object to draw the device contour on. If None, a</span>
<span class="sd">            new figure and axes will be created. Defaults to None.</span>
<span class="sd">        **kwargs</span>
<span class="sd">            Additional matplotlib parameters for plot customization.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Axes</span>
<span class="sd">            The matplotlib Axes object containing the contour plot. This can be used for</span>
<span class="sd">            further customization or saving the plot after the method returns.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">kwargs</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s2">&quot;cmap&quot;</span><span class="p">,</span> <span class="s2">&quot;spring&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">linewidth</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">linewidth</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">device_array</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">//</span> <span class="mi">100</span>

        <span class="n">contours</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">findContours</span><span class="p">(</span>
            <span class="n">geometry</span><span class="o">.</span><span class="n">binarize_hard</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">device_array</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">),</span>
            <span class="n">cv2</span><span class="o">.</span><span class="n">RETR_CCOMP</span><span class="p">,</span>
            <span class="n">cv2</span><span class="o">.</span><span class="n">CHAIN_APPROX_SIMPLE</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">contour_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">device_array</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
        <span class="n">cv2</span><span class="o">.</span><span class="n">drawContours</span><span class="p">(</span><span class="n">contour_array</span><span class="p">,</span> <span class="n">contours</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="mi">255</span><span class="p">,),</span> <span class="n">linewidth</span><span class="p">)</span>
        <span class="n">contour_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">masked_equal</span><span class="p">(</span><span class="n">contour_array</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

        <span class="n">_</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_plot_base</span><span class="p">(</span>
            <span class="n">plot_array</span><span class="o">=</span><span class="n">contour_array</span><span class="p">,</span>
            <span class="n">show_buffer</span><span class="o">=</span><span class="n">show_buffer</span><span class="p">,</span>
            <span class="n">bounds</span><span class="o">=</span><span class="n">bounds</span><span class="p">,</span>
            <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="c1"># cmap = cm.get_cmap(kwargs.get(&quot;cmap&quot;, &quot;spring&quot;))</span>
        <span class="c1"># legend_proxy = Line2D([0], [0], linestyle=&quot;-&quot;, color=cmap(1))</span>
        <span class="c1"># ax.legend([legend_proxy], [label], loc=&quot;upper right&quot;)</span>
        <span class="k">return</span> <span class="n">ax</span>

    <span class="k">def</span> <span class="nf">plot_uncertainty</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">show_buffer</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">bounds</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">ax</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Axes</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Visualizes the uncertainty in the edge positions of the predicted device.</span>

<span class="sd">        This method plots the uncertainty associated with the positions of the edges of</span>
<span class="sd">        the device. The uncertainty is represented as a gradient, with areas of higher</span>
<span class="sd">        uncertainty indicating a greater likelihood of the edge position from run to run</span>
<span class="sd">        (due to inconsistencies in the fabrication process). This visualization can help</span>
<span class="sd">        in identifying areas within the device geometry that may require design</span>
<span class="sd">        adjustments to improve fabrication consistency.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        show_buffer : bool, optional</span>
<span class="sd">            If True, the buffer zones around the device will also be visualized. By</span>
<span class="sd">            default, it is set to True.</span>
<span class="sd">        bounds : Optional[tuple[tuple[int, int], tuple[int, int]]], optional</span>
<span class="sd">            Specifies the bounds for zooming into the device geometry, formatted as</span>
<span class="sd">            ((min_x, min_y), (max_x, max_y)). If &#39;max_x&#39; or &#39;max_y&#39; is set to &quot;end&quot;, it</span>
<span class="sd">            will be replaced with the corresponding dimension size of the device array.</span>
<span class="sd">            If None, the entire device geometry is visualized.</span>
<span class="sd">        ax : Optional[Axes], optional</span>
<span class="sd">            An existing matplotlib Axes object to draw the uncertainty visualization on.</span>
<span class="sd">            If None, a new figure and axes will be created. Defaults to None.</span>
<span class="sd">        **kwargs</span>
<span class="sd">            Additional matplotlib parameters for plot customization.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Axes</span>
<span class="sd">            The matplotlib Axes object containing the uncertainty visualization. This</span>
<span class="sd">            can be used for further customization or saving the plot after the method</span>
<span class="sd">            returns.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">uncertainty_array</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="mf">0.5</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">device_array</span><span class="p">)</span>

        <span class="n">mappable</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_plot_base</span><span class="p">(</span>
            <span class="n">plot_array</span><span class="o">=</span><span class="n">uncertainty_array</span><span class="p">,</span>
            <span class="n">show_buffer</span><span class="o">=</span><span class="n">show_buffer</span><span class="p">,</span>
            <span class="n">bounds</span><span class="o">=</span><span class="n">bounds</span><span class="p">,</span>
            <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">cbar</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">mappable</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
        <span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s2">&quot;Uncertainty (a.u.)&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">ax</span>

    <span class="k">def</span> <span class="nf">_add_buffer_visualization</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">:</span> <span class="n">Axes</span><span class="p">):</span>
        <span class="n">plot_array</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">device_array</span>

        <span class="n">buffer_thickness</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">buffer_spec</span><span class="o">.</span><span class="n">thickness</span>
        <span class="n">buffer_fill</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">)</span>
        <span class="n">buffer_hatch</span> <span class="o">=</span> <span class="s2">&quot;/&quot;</span>

        <span class="n">mid_rect</span> <span class="o">=</span> <span class="n">Rectangle</span><span class="p">(</span>
            <span class="p">(</span><span class="n">buffer_thickness</span><span class="p">,</span> <span class="n">buffer_thickness</span><span class="p">),</span>
            <span class="n">plot_array</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">buffer_thickness</span><span class="p">,</span>
            <span class="n">plot_array</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">buffer_thickness</span><span class="p">,</span>
            <span class="n">facecolor</span><span class="o">=</span><span class="s2">&quot;none&quot;</span><span class="p">,</span>
            <span class="n">edgecolor</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span>
            <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">mid_rect</span><span class="p">)</span>

        <span class="n">top_rect</span> <span class="o">=</span> <span class="n">Rectangle</span><span class="p">(</span>
            <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
            <span class="n">plot_array</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
            <span class="n">buffer_thickness</span><span class="p">,</span>
            <span class="n">facecolor</span><span class="o">=</span><span class="n">buffer_fill</span><span class="p">,</span>
            <span class="n">hatch</span><span class="o">=</span><span class="n">buffer_hatch</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">top_rect</span><span class="p">)</span>

        <span class="n">bottom_rect</span> <span class="o">=</span> <span class="n">Rectangle</span><span class="p">(</span>
            <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">plot_array</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">buffer_thickness</span><span class="p">),</span>
            <span class="n">plot_array</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
            <span class="n">buffer_thickness</span><span class="p">,</span>
            <span class="n">facecolor</span><span class="o">=</span><span class="n">buffer_fill</span><span class="p">,</span>
            <span class="n">hatch</span><span class="o">=</span><span class="n">buffer_hatch</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">bottom_rect</span><span class="p">)</span>

        <span class="n">left_rect</span> <span class="o">=</span> <span class="n">Rectangle</span><span class="p">(</span>
            <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">buffer_thickness</span><span class="p">),</span>
            <span class="n">buffer_thickness</span><span class="p">,</span>
            <span class="n">plot_array</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">buffer_thickness</span><span class="p">,</span>
            <span class="n">facecolor</span><span class="o">=</span><span class="n">buffer_fill</span><span class="p">,</span>
            <span class="n">hatch</span><span class="o">=</span><span class="n">buffer_hatch</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">left_rect</span><span class="p">)</span>

        <span class="n">right_rect</span> <span class="o">=</span> <span class="n">Rectangle</span><span class="p">(</span>
            <span class="p">(</span>
                <span class="n">plot_array</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">buffer_thickness</span><span class="p">,</span>
                <span class="n">buffer_thickness</span><span class="p">,</span>
            <span class="p">),</span>
            <span class="n">buffer_thickness</span><span class="p">,</span>
            <span class="n">plot_array</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">buffer_thickness</span><span class="p">,</span>
            <span class="n">facecolor</span><span class="o">=</span><span class="n">buffer_fill</span><span class="p">,</span>
            <span class="n">hatch</span><span class="o">=</span><span class="n">buffer_hatch</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">right_rect</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">normalize</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Device&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Normalize the device geometry.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Device</span>
<span class="sd">            A new instance of the Device with the normalized geometry.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">normalized_device_array</span> <span class="o">=</span> <span class="n">geometry</span><span class="o">.</span><span class="n">normalize</span><span class="p">(</span><span class="n">device_array</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">device_array</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_copy</span><span class="p">(</span><span class="n">update</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;device_array&quot;</span><span class="p">:</span> <span class="n">normalized_device_array</span><span class="p">})</span>

    <span class="k">def</span> <span class="nf">binarize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">eta</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">beta</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Device&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Binarize the device geometry based on a threshold and a scaling factor.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        eta : float, optional</span>
<span class="sd">            The threshold value for binarization. Defaults to 0.5.</span>
<span class="sd">        beta : float, optional</span>
<span class="sd">            The scaling factor for the binarization process. A higher value makes the</span>
<span class="sd">            transition sharper. Defaults to np.inf, which results in a hard threshold.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Device</span>
<span class="sd">            A new instance of the Device with the binarized geometry.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">binarized_device_array</span> <span class="o">=</span> <span class="n">geometry</span><span class="o">.</span><span class="n">binarize</span><span class="p">(</span>
            <span class="n">device_array</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">device_array</span><span class="p">,</span> <span class="n">eta</span><span class="o">=</span><span class="n">eta</span><span class="p">,</span> <span class="n">beta</span><span class="o">=</span><span class="n">beta</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_copy</span><span class="p">(</span><span class="n">update</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;device_array&quot;</span><span class="p">:</span> <span class="n">binarized_device_array</span><span class="p">})</span>

    <span class="k">def</span> <span class="nf">binarize_hard</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">eta</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Device&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Apply a hard threshold to binarize the device geometry.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        eta : float, optional</span>
<span class="sd">            The threshold value for binarization. Defaults to 0.5.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Device</span>
<span class="sd">            A new instance of the Device with the threshold-binarized geometry.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">binarized_device_array</span> <span class="o">=</span> <span class="n">geometry</span><span class="o">.</span><span class="n">binarize_hard</span><span class="p">(</span>
            <span class="n">device_array</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">device_array</span><span class="p">,</span> <span class="n">eta</span><span class="o">=</span><span class="n">eta</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_copy</span><span class="p">(</span><span class="n">update</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;device_array&quot;</span><span class="p">:</span> <span class="n">binarized_device_array</span><span class="p">})</span>

    <span class="k">def</span> <span class="nf">binarize_monte_carlo</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">threshold_noise_std</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">2.0</span><span class="p">,</span>
        <span class="n">threshold_blur_std</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">9.0</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Device&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Binarize the device geometry using a Monte Carlo approach with Gaussian</span>
<span class="sd">        blurring.</span>

<span class="sd">        This method applies a dynamic thresholding technique where the threshold value</span>
<span class="sd">        is determined by a base value perturbed by Gaussian-distributed random noise.</span>
<span class="sd">        The threshold is then spatially varied across the device array using Gaussian</span>
<span class="sd">        blurring, simulating a more realistic scenario where the threshold is not</span>
<span class="sd">        uniform across the device.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        threshold_noise_std : float, optional</span>
<span class="sd">            The standard deviation of the Gaussian distribution used to generate noise</span>
<span class="sd">            for the threshold values. This controls the amount of randomness in the</span>
<span class="sd">            threshold. Defaults to 2.0.</span>
<span class="sd">        threshold_blur_std : float, optional</span>
<span class="sd">            The standard deviation for the Gaussian kernel used in blurring the</span>
<span class="sd">            threshold map. This controls the spatial variation of the threshold across</span>
<span class="sd">            the array. Defaults to 9.0.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Device</span>
<span class="sd">            A new instance of the Device with the binarized geometry.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">binarized_device_array</span> <span class="o">=</span> <span class="n">geometry</span><span class="o">.</span><span class="n">binarize_monte_carlo</span><span class="p">(</span>
            <span class="n">device_array</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">device_array</span><span class="p">,</span>
            <span class="n">threshold_noise_std</span><span class="o">=</span><span class="n">threshold_noise_std</span><span class="p">,</span>
            <span class="n">threshold_blur_std</span><span class="o">=</span><span class="n">threshold_blur_std</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_copy</span><span class="p">(</span><span class="n">update</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;device_array&quot;</span><span class="p">:</span> <span class="n">binarized_device_array</span><span class="p">})</span>

    <span class="k">def</span> <span class="nf">ternarize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">eta1</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">3</span><span class="p">,</span> <span class="n">eta2</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">/</span> <span class="mi">3</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Device&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Ternarize the device geometry based on two thresholds.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        eta1 : float, optional</span>
<span class="sd">            The first threshold value for ternarization. Defaults to 1/3.</span>
<span class="sd">        eta2 : float, optional</span>
<span class="sd">            The second threshold value for ternarization. Defaults to 2/3.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Device</span>
<span class="sd">            A new instance of the Device with the ternarized geometry.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ternarized_device_array</span> <span class="o">=</span> <span class="n">geometry</span><span class="o">.</span><span class="n">ternarize</span><span class="p">(</span>
            <span class="n">device_array</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">device_array</span><span class="p">,</span> <span class="n">eta1</span><span class="o">=</span><span class="n">eta1</span><span class="p">,</span> <span class="n">eta2</span><span class="o">=</span><span class="n">eta2</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_copy</span><span class="p">(</span><span class="n">update</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;device_array&quot;</span><span class="p">:</span> <span class="n">ternarized_device_array</span><span class="p">})</span>

    <span class="k">def</span> <span class="nf">trim</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Device&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Trim the device geometry by removing empty space around it.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        buffer_thickness : int, optional</span>
<span class="sd">            The thickness of the buffer to leave around the empty space. Defaults to 0,</span>
<span class="sd">            which means no buffer is added.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Device</span>
<span class="sd">            A new instance of the Device with the trimmed geometry.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">trimmed_device_array</span> <span class="o">=</span> <span class="n">geometry</span><span class="o">.</span><span class="n">trim</span><span class="p">(</span>
            <span class="n">device_array</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">device_array</span><span class="p">,</span>
            <span class="n">buffer_thickness</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">buffer_spec</span><span class="o">.</span><span class="n">thickness</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_copy</span><span class="p">(</span><span class="n">update</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;device_array&quot;</span><span class="p">:</span> <span class="n">trimmed_device_array</span><span class="p">})</span>

    <span class="k">def</span> <span class="nf">blur</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sigma</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Device&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Apply Gaussian blur to the device geometry and normalize the result.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        sigma : float, optional</span>
<span class="sd">            The standard deviation for the Gaussian kernel. This controls the amount of</span>
<span class="sd">            blurring. Defaults to 1.0.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Device</span>
<span class="sd">            A new instance of the Device with the blurred and normalized geometry.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">blurred_device_array</span> <span class="o">=</span> <span class="n">geometry</span><span class="o">.</span><span class="n">blur</span><span class="p">(</span>
            <span class="n">device_array</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">device_array</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="n">sigma</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_copy</span><span class="p">(</span><span class="n">update</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;device_array&quot;</span><span class="p">:</span> <span class="n">blurred_device_array</span><span class="p">})</span>

    <span class="k">def</span> <span class="nf">rotate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">angle</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Device&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Rotate the device geometry by a given angle.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        angle : float</span>
<span class="sd">            The angle of rotation in degrees. Positive values mean counter-clockwise</span>
<span class="sd">            rotation.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Device</span>
<span class="sd">            A new instance of the Device with the rotated geometry.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">rotated_device_array</span> <span class="o">=</span> <span class="n">geometry</span><span class="o">.</span><span class="n">rotate</span><span class="p">(</span>
            <span class="n">device_array</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">device_array</span><span class="p">,</span> <span class="n">angle</span><span class="o">=</span><span class="n">angle</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_copy</span><span class="p">(</span><span class="n">update</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;device_array&quot;</span><span class="p">:</span> <span class="n">rotated_device_array</span><span class="p">})</span>

    <span class="k">def</span> <span class="nf">erode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">kernel_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Device&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Erode the device geometry by removing small areas of overlap.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        kernel_size : int</span>
<span class="sd">            The size of the kernel used for erosion.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Device</span>
<span class="sd">            A new instance of the Device with the eroded geometry.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">eroded_device_array</span> <span class="o">=</span> <span class="n">geometry</span><span class="o">.</span><span class="n">erode</span><span class="p">(</span>
            <span class="n">device_array</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">device_array</span><span class="p">,</span> <span class="n">kernel_size</span><span class="o">=</span><span class="n">kernel_size</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_copy</span><span class="p">(</span><span class="n">update</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;device_array&quot;</span><span class="p">:</span> <span class="n">eroded_device_array</span><span class="p">})</span>

    <span class="k">def</span> <span class="nf">dilate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">kernel_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Device&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Dilate the device geometry by expanding areas of overlap.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        kernel_size : int</span>
<span class="sd">            The size of the kernel used for dilation.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Device</span>
<span class="sd">            A new instance of the Device with the dilated geometry.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">dilated_device_array</span> <span class="o">=</span> <span class="n">geometry</span><span class="o">.</span><span class="n">dilate</span><span class="p">(</span>
            <span class="n">device_array</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">device_array</span><span class="p">,</span> <span class="n">kernel_size</span><span class="o">=</span><span class="n">kernel_size</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_copy</span><span class="p">(</span><span class="n">update</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;device_array&quot;</span><span class="p">:</span> <span class="n">dilated_device_array</span><span class="p">})</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h3 id="prefab.device.Device.__init__" class="doc doc-heading">
          <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">device_array</span><span class="p">,</span> <span class="n">buffer_spec</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Represents the planar geometry of a photonic device design that will have its
nanofabrication outcome predicted and/or corrected.</p>
<p>This class is designed to encapsulate the geometric representation of a photonic
device, facilitating operations such as padding, normalization, binarization,
ternarization, trimming, and blurring. These operations are useful for preparing
the device design for prediction or correction. Additionally, the class provides
methods for exporting the device representation to various formats, including
ndarray, image files, and GDSII files, supporting a range of analysis and
fabrication workflows.</p>
<h5 id="prefab.device.Device.__init__--parameters">Parameters</h5>
<p>device_array : np.ndarray
    A 2D array representing the planar geometry of the device. This array
    undergoes various transformations to predict or correct the nanofabrication
    process.
buffer_spec : BufferSpec, optional
    Defines the parameters for adding a buffer zone around the device geometry.
    This buffer zone is needed for providing surrounding context for prediction
    or correction and for ensuring seamless integration with the surrounding
    circuitry. By default, a generous padding is applied to accommodate isolated
    structures.</p>
<h5 id="prefab.device.Device.__init__--attributes">Attributes</h5>
<p>shape : tuple[int, int]
    The shape of the device array.</p>
<h5 id="prefab.device.Device.__init__--raises">Raises</h5>
<p>ValueError
    If the provided <code>device_array</code> is not a numpy ndarray or is not a 2D array,
    indicating an invalid device geometry.</p>

          <details class="quote">
            <summary>Source code in <code>prefab/device.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">device_array</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">buffer_spec</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">BufferSpec</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Represents the planar geometry of a photonic device design that will have its</span>
<span class="sd">    nanofabrication outcome predicted and/or corrected.</span>

<span class="sd">    This class is designed to encapsulate the geometric representation of a photonic</span>
<span class="sd">    device, facilitating operations such as padding, normalization, binarization,</span>
<span class="sd">    ternarization, trimming, and blurring. These operations are useful for preparing</span>
<span class="sd">    the device design for prediction or correction. Additionally, the class provides</span>
<span class="sd">    methods for exporting the device representation to various formats, including</span>
<span class="sd">    ndarray, image files, and GDSII files, supporting a range of analysis and</span>
<span class="sd">    fabrication workflows.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    device_array : np.ndarray</span>
<span class="sd">        A 2D array representing the planar geometry of the device. This array</span>
<span class="sd">        undergoes various transformations to predict or correct the nanofabrication</span>
<span class="sd">        process.</span>
<span class="sd">    buffer_spec : BufferSpec, optional</span>
<span class="sd">        Defines the parameters for adding a buffer zone around the device geometry.</span>
<span class="sd">        This buffer zone is needed for providing surrounding context for prediction</span>
<span class="sd">        or correction and for ensuring seamless integration with the surrounding</span>
<span class="sd">        circuitry. By default, a generous padding is applied to accommodate isolated</span>
<span class="sd">        structures.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    shape : tuple[int, int]</span>
<span class="sd">        The shape of the device array.</span>

<span class="sd">    Raises</span>
<span class="sd">    ------</span>
<span class="sd">    ValueError</span>
<span class="sd">        If the provided `device_array` is not a numpy ndarray or is not a 2D array,</span>
<span class="sd">        indicating an invalid device geometry.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
        <span class="n">device_array</span><span class="o">=</span><span class="n">device_array</span><span class="p">,</span> <span class="n">buffer_spec</span><span class="o">=</span><span class="n">buffer_spec</span> <span class="ow">or</span> <span class="n">BufferSpec</span><span class="p">()</span>
    <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_initial_processing</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="prefab.device.Device.binarize" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">binarize</span><span class="p">(</span><span class="n">eta</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">beta</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Binarize the device geometry based on a threshold and a scaling factor.</p>
<h5 id="prefab.device.Device.binarize--parameters">Parameters</h5>
<p>eta : float, optional
    The threshold value for binarization. Defaults to 0.5.
beta : float, optional
    The scaling factor for the binarization process. A higher value makes the
    transition sharper. Defaults to np.inf, which results in a hard threshold.</p>
<h5 id="prefab.device.Device.binarize--returns">Returns</h5>
<p>Device
    A new instance of the Device with the binarized geometry.</p>

          <details class="quote">
            <summary>Source code in <code>prefab/device.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">847</span>
<span class="normal">848</span>
<span class="normal">849</span>
<span class="normal">850</span>
<span class="normal">851</span>
<span class="normal">852</span>
<span class="normal">853</span>
<span class="normal">854</span>
<span class="normal">855</span>
<span class="normal">856</span>
<span class="normal">857</span>
<span class="normal">858</span>
<span class="normal">859</span>
<span class="normal">860</span>
<span class="normal">861</span>
<span class="normal">862</span>
<span class="normal">863</span>
<span class="normal">864</span>
<span class="normal">865</span>
<span class="normal">866</span>
<span class="normal">867</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">binarize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">eta</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">beta</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Device&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Binarize the device geometry based on a threshold and a scaling factor.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    eta : float, optional</span>
<span class="sd">        The threshold value for binarization. Defaults to 0.5.</span>
<span class="sd">    beta : float, optional</span>
<span class="sd">        The scaling factor for the binarization process. A higher value makes the</span>
<span class="sd">        transition sharper. Defaults to np.inf, which results in a hard threshold.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Device</span>
<span class="sd">        A new instance of the Device with the binarized geometry.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">binarized_device_array</span> <span class="o">=</span> <span class="n">geometry</span><span class="o">.</span><span class="n">binarize</span><span class="p">(</span>
        <span class="n">device_array</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">device_array</span><span class="p">,</span> <span class="n">eta</span><span class="o">=</span><span class="n">eta</span><span class="p">,</span> <span class="n">beta</span><span class="o">=</span><span class="n">beta</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_copy</span><span class="p">(</span><span class="n">update</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;device_array&quot;</span><span class="p">:</span> <span class="n">binarized_device_array</span><span class="p">})</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="prefab.device.Device.binarize_hard" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">binarize_hard</span><span class="p">(</span><span class="n">eta</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Apply a hard threshold to binarize the device geometry.</p>
<h5 id="prefab.device.Device.binarize_hard--parameters">Parameters</h5>
<p>eta : float, optional
    The threshold value for binarization. Defaults to 0.5.</p>
<h5 id="prefab.device.Device.binarize_hard--returns">Returns</h5>
<p>Device
    A new instance of the Device with the threshold-binarized geometry.</p>

          <details class="quote">
            <summary>Source code in <code>prefab/device.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">869</span>
<span class="normal">870</span>
<span class="normal">871</span>
<span class="normal">872</span>
<span class="normal">873</span>
<span class="normal">874</span>
<span class="normal">875</span>
<span class="normal">876</span>
<span class="normal">877</span>
<span class="normal">878</span>
<span class="normal">879</span>
<span class="normal">880</span>
<span class="normal">881</span>
<span class="normal">882</span>
<span class="normal">883</span>
<span class="normal">884</span>
<span class="normal">885</span>
<span class="normal">886</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">binarize_hard</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">eta</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Device&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Apply a hard threshold to binarize the device geometry.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    eta : float, optional</span>
<span class="sd">        The threshold value for binarization. Defaults to 0.5.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Device</span>
<span class="sd">        A new instance of the Device with the threshold-binarized geometry.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">binarized_device_array</span> <span class="o">=</span> <span class="n">geometry</span><span class="o">.</span><span class="n">binarize_hard</span><span class="p">(</span>
        <span class="n">device_array</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">device_array</span><span class="p">,</span> <span class="n">eta</span><span class="o">=</span><span class="n">eta</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_copy</span><span class="p">(</span><span class="n">update</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;device_array&quot;</span><span class="p">:</span> <span class="n">binarized_device_array</span><span class="p">})</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="prefab.device.Device.binarize_monte_carlo" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">binarize_monte_carlo</span><span class="p">(</span><span class="n">threshold_noise_std</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">threshold_blur_std</span><span class="o">=</span><span class="mf">9.0</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Binarize the device geometry using a Monte Carlo approach with Gaussian
blurring.</p>
<p>This method applies a dynamic thresholding technique where the threshold value
is determined by a base value perturbed by Gaussian-distributed random noise.
The threshold is then spatially varied across the device array using Gaussian
blurring, simulating a more realistic scenario where the threshold is not
uniform across the device.</p>
<h5 id="prefab.device.Device.binarize_monte_carlo--parameters">Parameters</h5>
<p>threshold_noise_std : float, optional
    The standard deviation of the Gaussian distribution used to generate noise
    for the threshold values. This controls the amount of randomness in the
    threshold. Defaults to 2.0.
threshold_blur_std : float, optional
    The standard deviation for the Gaussian kernel used in blurring the
    threshold map. This controls the spatial variation of the threshold across
    the array. Defaults to 9.0.</p>
<h5 id="prefab.device.Device.binarize_monte_carlo--returns">Returns</h5>
<p>Device
    A new instance of the Device with the binarized geometry.</p>

          <details class="quote">
            <summary>Source code in <code>prefab/device.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">888</span>
<span class="normal">889</span>
<span class="normal">890</span>
<span class="normal">891</span>
<span class="normal">892</span>
<span class="normal">893</span>
<span class="normal">894</span>
<span class="normal">895</span>
<span class="normal">896</span>
<span class="normal">897</span>
<span class="normal">898</span>
<span class="normal">899</span>
<span class="normal">900</span>
<span class="normal">901</span>
<span class="normal">902</span>
<span class="normal">903</span>
<span class="normal">904</span>
<span class="normal">905</span>
<span class="normal">906</span>
<span class="normal">907</span>
<span class="normal">908</span>
<span class="normal">909</span>
<span class="normal">910</span>
<span class="normal">911</span>
<span class="normal">912</span>
<span class="normal">913</span>
<span class="normal">914</span>
<span class="normal">915</span>
<span class="normal">916</span>
<span class="normal">917</span>
<span class="normal">918</span>
<span class="normal">919</span>
<span class="normal">920</span>
<span class="normal">921</span>
<span class="normal">922</span>
<span class="normal">923</span>
<span class="normal">924</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">binarize_monte_carlo</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">threshold_noise_std</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">2.0</span><span class="p">,</span>
    <span class="n">threshold_blur_std</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">9.0</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Device&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Binarize the device geometry using a Monte Carlo approach with Gaussian</span>
<span class="sd">    blurring.</span>

<span class="sd">    This method applies a dynamic thresholding technique where the threshold value</span>
<span class="sd">    is determined by a base value perturbed by Gaussian-distributed random noise.</span>
<span class="sd">    The threshold is then spatially varied across the device array using Gaussian</span>
<span class="sd">    blurring, simulating a more realistic scenario where the threshold is not</span>
<span class="sd">    uniform across the device.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    threshold_noise_std : float, optional</span>
<span class="sd">        The standard deviation of the Gaussian distribution used to generate noise</span>
<span class="sd">        for the threshold values. This controls the amount of randomness in the</span>
<span class="sd">        threshold. Defaults to 2.0.</span>
<span class="sd">    threshold_blur_std : float, optional</span>
<span class="sd">        The standard deviation for the Gaussian kernel used in blurring the</span>
<span class="sd">        threshold map. This controls the spatial variation of the threshold across</span>
<span class="sd">        the array. Defaults to 9.0.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Device</span>
<span class="sd">        A new instance of the Device with the binarized geometry.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">binarized_device_array</span> <span class="o">=</span> <span class="n">geometry</span><span class="o">.</span><span class="n">binarize_monte_carlo</span><span class="p">(</span>
        <span class="n">device_array</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">device_array</span><span class="p">,</span>
        <span class="n">threshold_noise_std</span><span class="o">=</span><span class="n">threshold_noise_std</span><span class="p">,</span>
        <span class="n">threshold_blur_std</span><span class="o">=</span><span class="n">threshold_blur_std</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_copy</span><span class="p">(</span><span class="n">update</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;device_array&quot;</span><span class="p">:</span> <span class="n">binarized_device_array</span><span class="p">})</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="prefab.device.Device.blur" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">blur</span><span class="p">(</span><span class="n">sigma</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Apply Gaussian blur to the device geometry and normalize the result.</p>
<h5 id="prefab.device.Device.blur--parameters">Parameters</h5>
<p>sigma : float, optional
    The standard deviation for the Gaussian kernel. This controls the amount of
    blurring. Defaults to 1.0.</p>
<h5 id="prefab.device.Device.blur--returns">Returns</h5>
<p>Device
    A new instance of the Device with the blurred and normalized geometry.</p>

          <details class="quote">
            <summary>Source code in <code>prefab/device.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">968</span>
<span class="normal">969</span>
<span class="normal">970</span>
<span class="normal">971</span>
<span class="normal">972</span>
<span class="normal">973</span>
<span class="normal">974</span>
<span class="normal">975</span>
<span class="normal">976</span>
<span class="normal">977</span>
<span class="normal">978</span>
<span class="normal">979</span>
<span class="normal">980</span>
<span class="normal">981</span>
<span class="normal">982</span>
<span class="normal">983</span>
<span class="normal">984</span>
<span class="normal">985</span>
<span class="normal">986</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">blur</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sigma</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Device&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Apply Gaussian blur to the device geometry and normalize the result.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    sigma : float, optional</span>
<span class="sd">        The standard deviation for the Gaussian kernel. This controls the amount of</span>
<span class="sd">        blurring. Defaults to 1.0.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Device</span>
<span class="sd">        A new instance of the Device with the blurred and normalized geometry.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">blurred_device_array</span> <span class="o">=</span> <span class="n">geometry</span><span class="o">.</span><span class="n">blur</span><span class="p">(</span>
        <span class="n">device_array</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">device_array</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="n">sigma</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_copy</span><span class="p">(</span><span class="n">update</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;device_array&quot;</span><span class="p">:</span> <span class="n">blurred_device_array</span><span class="p">})</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="prefab.device.Device.correct" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">correct</span><span class="p">(</span><span class="n">model_name</span><span class="p">,</span> <span class="n">model_tags</span><span class="p">,</span> <span class="n">binarize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Correct the nanofabrication outcome of the device using a specified model.</p>
<p>This method sends the device geometry to a serverless correction service, which
uses a specified machine learning model to correct the outcome of the
nanofabrication process. The correction aims to adjust the device geometry to
compensate for known fabrication errors and improve the accuracy of the final
device structure.</p>
<h5 id="prefab.device.Device.correct--parameters">Parameters</h5>
<p>model_name : str
    The name of the model to use for correction.
model_tags : list[str]
    A list of tags associated with the model. These tags can be used to specify
    model versions or configurations.
binarize : bool, optional
    If True, the corrected device geometry will be binarized using a threshold
    method. This is useful for converting probabilistic corrections into binary
    geometries. Defaults to True.</p>
<h5 id="prefab.device.Device.correct--returns">Returns</h5>
<p>Device
    A new instance of the Device class with the corrected geometry.</p>
<h5 id="prefab.device.Device.correct--raises">Raises</h5>
<p>ValueError
    If the correction service returns an error or if the response from the
    service cannot be processed correctly.</p>

          <details class="quote">
            <summary>Source code in <code>prefab/device.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">correct</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">model_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">model_tags</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
    <span class="n">binarize</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Device&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Correct the nanofabrication outcome of the device using a specified model.</span>

<span class="sd">    This method sends the device geometry to a serverless correction service, which</span>
<span class="sd">    uses a specified machine learning model to correct the outcome of the</span>
<span class="sd">    nanofabrication process. The correction aims to adjust the device geometry to</span>
<span class="sd">    compensate for known fabrication errors and improve the accuracy of the final</span>
<span class="sd">    device structure.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    model_name : str</span>
<span class="sd">        The name of the model to use for correction.</span>
<span class="sd">    model_tags : list[str]</span>
<span class="sd">        A list of tags associated with the model. These tags can be used to specify</span>
<span class="sd">        model versions or configurations.</span>
<span class="sd">    binarize : bool, optional</span>
<span class="sd">        If True, the corrected device geometry will be binarized using a threshold</span>
<span class="sd">        method. This is useful for converting probabilistic corrections into binary</span>
<span class="sd">        geometries. Defaults to True.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Device</span>
<span class="sd">        A new instance of the Device class with the corrected geometry.</span>

<span class="sd">    Raises</span>
<span class="sd">    ------</span>
<span class="sd">    ValueError</span>
<span class="sd">        If the correction service returns an error or if the response from the</span>
<span class="sd">        service cannot be processed correctly.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_predict</span><span class="p">(</span>
        <span class="n">model_name</span><span class="o">=</span><span class="n">model_name</span><span class="p">,</span>
        <span class="n">model_tags</span><span class="o">=</span><span class="n">model_tags</span><span class="p">,</span>
        <span class="n">model_type</span><span class="o">=</span><span class="s2">&quot;c&quot;</span><span class="p">,</span>
        <span class="n">binarize</span><span class="o">=</span><span class="n">binarize</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="prefab.device.Device.dilate" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">dilate</span><span class="p">(</span><span class="n">kernel_size</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Dilate the device geometry by expanding areas of overlap.</p>
<h5 id="prefab.device.Device.dilate--parameters">Parameters</h5>
<p>kernel_size : int
    The size of the kernel used for dilation.</p>
<h5 id="prefab.device.Device.dilate--returns">Returns</h5>
<p>Device
    A new instance of the Device with the dilated geometry.</p>

          <details class="quote">
            <summary>Source code in <code>prefab/device.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1027</span>
<span class="normal">1028</span>
<span class="normal">1029</span>
<span class="normal">1030</span>
<span class="normal">1031</span>
<span class="normal">1032</span>
<span class="normal">1033</span>
<span class="normal">1034</span>
<span class="normal">1035</span>
<span class="normal">1036</span>
<span class="normal">1037</span>
<span class="normal">1038</span>
<span class="normal">1039</span>
<span class="normal">1040</span>
<span class="normal">1041</span>
<span class="normal">1042</span>
<span class="normal">1043</span>
<span class="normal">1044</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">dilate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">kernel_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Device&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Dilate the device geometry by expanding areas of overlap.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    kernel_size : int</span>
<span class="sd">        The size of the kernel used for dilation.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Device</span>
<span class="sd">        A new instance of the Device with the dilated geometry.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">dilated_device_array</span> <span class="o">=</span> <span class="n">geometry</span><span class="o">.</span><span class="n">dilate</span><span class="p">(</span>
        <span class="n">device_array</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">device_array</span><span class="p">,</span> <span class="n">kernel_size</span><span class="o">=</span><span class="n">kernel_size</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_copy</span><span class="p">(</span><span class="n">update</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;device_array&quot;</span><span class="p">:</span> <span class="n">dilated_device_array</span><span class="p">})</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="prefab.device.Device.erode" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">erode</span><span class="p">(</span><span class="n">kernel_size</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Erode the device geometry by removing small areas of overlap.</p>
<h5 id="prefab.device.Device.erode--parameters">Parameters</h5>
<p>kernel_size : int
    The size of the kernel used for erosion.</p>
<h5 id="prefab.device.Device.erode--returns">Returns</h5>
<p>Device
    A new instance of the Device with the eroded geometry.</p>

          <details class="quote">
            <summary>Source code in <code>prefab/device.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1008</span>
<span class="normal">1009</span>
<span class="normal">1010</span>
<span class="normal">1011</span>
<span class="normal">1012</span>
<span class="normal">1013</span>
<span class="normal">1014</span>
<span class="normal">1015</span>
<span class="normal">1016</span>
<span class="normal">1017</span>
<span class="normal">1018</span>
<span class="normal">1019</span>
<span class="normal">1020</span>
<span class="normal">1021</span>
<span class="normal">1022</span>
<span class="normal">1023</span>
<span class="normal">1024</span>
<span class="normal">1025</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">erode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">kernel_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Device&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Erode the device geometry by removing small areas of overlap.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    kernel_size : int</span>
<span class="sd">        The size of the kernel used for erosion.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Device</span>
<span class="sd">        A new instance of the Device with the eroded geometry.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">eroded_device_array</span> <span class="o">=</span> <span class="n">geometry</span><span class="o">.</span><span class="n">erode</span><span class="p">(</span>
        <span class="n">device_array</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">device_array</span><span class="p">,</span> <span class="n">kernel_size</span><span class="o">=</span><span class="n">kernel_size</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_copy</span><span class="p">(</span><span class="n">update</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;device_array&quot;</span><span class="p">:</span> <span class="n">eroded_device_array</span><span class="p">})</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="prefab.device.Device.is_binary" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">is_binary</span><span class="p">()</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Check if the device geometry is binary.</p>
<h5 id="prefab.device.Device.is_binary--returns">Returns</h5>
<p>bool
    True if the device geometry is binary, False otherwise.</p>

          <details class="quote">
            <summary>Source code in <code>prefab/device.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">is_binary</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Check if the device geometry is binary.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    bool</span>
<span class="sd">        True if the device geometry is binary, False otherwise.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">unique_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">device_array</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">(</span>
        <span class="n">np</span><span class="o">.</span><span class="n">array_equal</span><span class="p">(</span><span class="n">unique_values</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
        <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">array_equal</span><span class="p">(</span><span class="n">unique_values</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
        <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">array_equal</span><span class="p">(</span><span class="n">unique_values</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">array_equal</span><span class="p">(</span><span class="n">unique_values</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="prefab.device.Device.normalize" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">normalize</span><span class="p">()</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Normalize the device geometry.</p>
<h5 id="prefab.device.Device.normalize--returns">Returns</h5>
<p>Device
    A new instance of the Device with the normalized geometry.</p>

          <details class="quote">
            <summary>Source code in <code>prefab/device.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">835</span>
<span class="normal">836</span>
<span class="normal">837</span>
<span class="normal">838</span>
<span class="normal">839</span>
<span class="normal">840</span>
<span class="normal">841</span>
<span class="normal">842</span>
<span class="normal">843</span>
<span class="normal">844</span>
<span class="normal">845</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">normalize</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Device&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Normalize the device geometry.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Device</span>
<span class="sd">        A new instance of the Device with the normalized geometry.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">normalized_device_array</span> <span class="o">=</span> <span class="n">geometry</span><span class="o">.</span><span class="n">normalize</span><span class="p">(</span><span class="n">device_array</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">device_array</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_copy</span><span class="p">(</span><span class="n">update</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;device_array&quot;</span><span class="p">:</span> <span class="n">normalized_device_array</span><span class="p">})</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="prefab.device.Device.plot" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">plot</span><span class="p">(</span><span class="n">show_buffer</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Visualizes the device geometry, optionally including buffer zones.</p>
<p>This method allows for the visualization of the device geometry with an option
to include buffer zones. It supports zooming into a specific area of the device.
The visualization can be customized with various matplotlib parameters and can
be drawn on an existing matplotlib Axes object or create a new one if none is
provided.</p>
<h5 id="prefab.device.Device.plot--parameters">Parameters</h5>
<p>show_buffer : bool, optional
    If True, visualizes the buffer zones around the device to provide spatial
    context. Defaults to True.
bounds : Optional[tuple[tuple[int, int], tuple[int, int]]], optional
    Specifies the bounds for zooming into the device geometry, formatted as
    ((min_x, min_y), (max_x, max_y)). If 'max_x' or 'max_y' is set to "end", it
    will be replaced with the corresponding dimension size of the device array.
    If None, the entire device geometry is visualized.
ax : Optional[Axes], optional
    An existing matplotlib Axes object to draw the device geometry on. If
    None, a new figure and axes will be created. Defaults to None.
**kwargs
    Additional matplotlib parameters for plot customization.</p>
<h5 id="prefab.device.Device.plot--returns">Returns</h5>
<p>Axes
    The matplotlib Axes object containing the plot. This object can be used for
    further plot customization or saving the plot after the method returns.</p>

          <details class="quote">
            <summary>Source code in <code>prefab/device.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">plot</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">show_buffer</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">bounds</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">ax</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Axes</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Axes</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Visualizes the device geometry, optionally including buffer zones.</span>

<span class="sd">    This method allows for the visualization of the device geometry with an option</span>
<span class="sd">    to include buffer zones. It supports zooming into a specific area of the device.</span>
<span class="sd">    The visualization can be customized with various matplotlib parameters and can</span>
<span class="sd">    be drawn on an existing matplotlib Axes object or create a new one if none is</span>
<span class="sd">    provided.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    show_buffer : bool, optional</span>
<span class="sd">        If True, visualizes the buffer zones around the device to provide spatial</span>
<span class="sd">        context. Defaults to True.</span>
<span class="sd">    bounds : Optional[tuple[tuple[int, int], tuple[int, int]]], optional</span>
<span class="sd">        Specifies the bounds for zooming into the device geometry, formatted as</span>
<span class="sd">        ((min_x, min_y), (max_x, max_y)). If &#39;max_x&#39; or &#39;max_y&#39; is set to &quot;end&quot;, it</span>
<span class="sd">        will be replaced with the corresponding dimension size of the device array.</span>
<span class="sd">        If None, the entire device geometry is visualized.</span>
<span class="sd">    ax : Optional[Axes], optional</span>
<span class="sd">        An existing matplotlib Axes object to draw the device geometry on. If</span>
<span class="sd">        None, a new figure and axes will be created. Defaults to None.</span>
<span class="sd">    **kwargs</span>
<span class="sd">        Additional matplotlib parameters for plot customization.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Axes</span>
<span class="sd">        The matplotlib Axes object containing the plot. This object can be used for</span>
<span class="sd">        further plot customization or saving the plot after the method returns.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">_</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_plot_base</span><span class="p">(</span>
        <span class="n">plot_array</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">device_array</span><span class="p">,</span>
        <span class="n">show_buffer</span><span class="o">=</span><span class="n">show_buffer</span><span class="p">,</span>
        <span class="n">bounds</span><span class="o">=</span><span class="n">bounds</span><span class="p">,</span>
        <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">ax</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="prefab.device.Device.plot_contour" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">plot_contour</span><span class="p">(</span><span class="n">linewidth</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">show_buffer</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Visualizes the contour of the device along with optional buffer zones.</p>
<p>This method plots the contour of the device geometry, emphasizing the edges and
boundaries of the device. The contour plot can be customized with various
matplotlib parameters, including line width and color. The plot can be drawn on
an existing matplotlib Axes object or create a new one if none is provided.</p>
<h5 id="prefab.device.Device.plot_contour--parameters">Parameters</h5>
<p>linewidth : Optional[int], optional
    The width of the contour lines. If None, the linewidth is automatically
    determined based on the size of the device array. Defaults to None.
show_buffer : bool, optional
    If True, the buffer zones around the device will be visualized. By default,
    it is set to True.
bounds : Optional[tuple[tuple[int, int], tuple[int, int]]], optional
    Specifies the bounds for zooming into the device geometry, formatted as
    ((min_x, min_y), (max_x, max_y)). If 'max_x' or 'max_y' is set to "end", it
    will be replaced with the corresponding dimension size of the device array.
    If None, the entire device geometry is visualized.
ax : Optional[Axes], optional
    An existing matplotlib Axes object to draw the device contour on. If None, a
    new figure and axes will be created. Defaults to None.
**kwargs
    Additional matplotlib parameters for plot customization.</p>
<h5 id="prefab.device.Device.plot_contour--returns">Returns</h5>
<p>Axes
    The matplotlib Axes object containing the contour plot. This can be used for
    further customization or saving the plot after the method returns.</p>

          <details class="quote">
            <summary>Source code in <code>prefab/device.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">plot_contour</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">linewidth</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="c1"># label: Optional[str] = &quot;Device contour&quot;,</span>
    <span class="n">show_buffer</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">bounds</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">ax</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Axes</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Visualizes the contour of the device along with optional buffer zones.</span>

<span class="sd">    This method plots the contour of the device geometry, emphasizing the edges and</span>
<span class="sd">    boundaries of the device. The contour plot can be customized with various</span>
<span class="sd">    matplotlib parameters, including line width and color. The plot can be drawn on</span>
<span class="sd">    an existing matplotlib Axes object or create a new one if none is provided.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    linewidth : Optional[int], optional</span>
<span class="sd">        The width of the contour lines. If None, the linewidth is automatically</span>
<span class="sd">        determined based on the size of the device array. Defaults to None.</span>
<span class="sd">    show_buffer : bool, optional</span>
<span class="sd">        If True, the buffer zones around the device will be visualized. By default,</span>
<span class="sd">        it is set to True.</span>
<span class="sd">    bounds : Optional[tuple[tuple[int, int], tuple[int, int]]], optional</span>
<span class="sd">        Specifies the bounds for zooming into the device geometry, formatted as</span>
<span class="sd">        ((min_x, min_y), (max_x, max_y)). If &#39;max_x&#39; or &#39;max_y&#39; is set to &quot;end&quot;, it</span>
<span class="sd">        will be replaced with the corresponding dimension size of the device array.</span>
<span class="sd">        If None, the entire device geometry is visualized.</span>
<span class="sd">    ax : Optional[Axes], optional</span>
<span class="sd">        An existing matplotlib Axes object to draw the device contour on. If None, a</span>
<span class="sd">        new figure and axes will be created. Defaults to None.</span>
<span class="sd">    **kwargs</span>
<span class="sd">        Additional matplotlib parameters for plot customization.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Axes</span>
<span class="sd">        The matplotlib Axes object containing the contour plot. This can be used for</span>
<span class="sd">        further customization or saving the plot after the method returns.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">kwargs</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s2">&quot;cmap&quot;</span><span class="p">,</span> <span class="s2">&quot;spring&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">linewidth</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">linewidth</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">device_array</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">//</span> <span class="mi">100</span>

    <span class="n">contours</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">findContours</span><span class="p">(</span>
        <span class="n">geometry</span><span class="o">.</span><span class="n">binarize_hard</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">device_array</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">),</span>
        <span class="n">cv2</span><span class="o">.</span><span class="n">RETR_CCOMP</span><span class="p">,</span>
        <span class="n">cv2</span><span class="o">.</span><span class="n">CHAIN_APPROX_SIMPLE</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">contour_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">device_array</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
    <span class="n">cv2</span><span class="o">.</span><span class="n">drawContours</span><span class="p">(</span><span class="n">contour_array</span><span class="p">,</span> <span class="n">contours</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="mi">255</span><span class="p">,),</span> <span class="n">linewidth</span><span class="p">)</span>
    <span class="n">contour_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">masked_equal</span><span class="p">(</span><span class="n">contour_array</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

    <span class="n">_</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_plot_base</span><span class="p">(</span>
        <span class="n">plot_array</span><span class="o">=</span><span class="n">contour_array</span><span class="p">,</span>
        <span class="n">show_buffer</span><span class="o">=</span><span class="n">show_buffer</span><span class="p">,</span>
        <span class="n">bounds</span><span class="o">=</span><span class="n">bounds</span><span class="p">,</span>
        <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="c1"># cmap = cm.get_cmap(kwargs.get(&quot;cmap&quot;, &quot;spring&quot;))</span>
    <span class="c1"># legend_proxy = Line2D([0], [0], linestyle=&quot;-&quot;, color=cmap(1))</span>
    <span class="c1"># ax.legend([legend_proxy], [label], loc=&quot;upper right&quot;)</span>
    <span class="k">return</span> <span class="n">ax</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="prefab.device.Device.plot_uncertainty" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">plot_uncertainty</span><span class="p">(</span><span class="n">show_buffer</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Visualizes the uncertainty in the edge positions of the predicted device.</p>
<p>This method plots the uncertainty associated with the positions of the edges of
the device. The uncertainty is represented as a gradient, with areas of higher
uncertainty indicating a greater likelihood of the edge position from run to run
(due to inconsistencies in the fabrication process). This visualization can help
in identifying areas within the device geometry that may require design
adjustments to improve fabrication consistency.</p>
<h5 id="prefab.device.Device.plot_uncertainty--parameters">Parameters</h5>
<p>show_buffer : bool, optional
    If True, the buffer zones around the device will also be visualized. By
    default, it is set to True.
bounds : Optional[tuple[tuple[int, int], tuple[int, int]]], optional
    Specifies the bounds for zooming into the device geometry, formatted as
    ((min_x, min_y), (max_x, max_y)). If 'max_x' or 'max_y' is set to "end", it
    will be replaced with the corresponding dimension size of the device array.
    If None, the entire device geometry is visualized.
ax : Optional[Axes], optional
    An existing matplotlib Axes object to draw the uncertainty visualization on.
    If None, a new figure and axes will be created. Defaults to None.
**kwargs
    Additional matplotlib parameters for plot customization.</p>
<h5 id="prefab.device.Device.plot_uncertainty--returns">Returns</h5>
<p>Axes
    The matplotlib Axes object containing the uncertainty visualization. This
    can be used for further customization or saving the plot after the method
    returns.</p>

          <details class="quote">
            <summary>Source code in <code>prefab/device.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span>
<span class="normal">740</span>
<span class="normal">741</span>
<span class="normal">742</span>
<span class="normal">743</span>
<span class="normal">744</span>
<span class="normal">745</span>
<span class="normal">746</span>
<span class="normal">747</span>
<span class="normal">748</span>
<span class="normal">749</span>
<span class="normal">750</span>
<span class="normal">751</span>
<span class="normal">752</span>
<span class="normal">753</span>
<span class="normal">754</span>
<span class="normal">755</span>
<span class="normal">756</span>
<span class="normal">757</span>
<span class="normal">758</span>
<span class="normal">759</span>
<span class="normal">760</span>
<span class="normal">761</span>
<span class="normal">762</span>
<span class="normal">763</span>
<span class="normal">764</span>
<span class="normal">765</span>
<span class="normal">766</span>
<span class="normal">767</span>
<span class="normal">768</span>
<span class="normal">769</span>
<span class="normal">770</span>
<span class="normal">771</span>
<span class="normal">772</span>
<span class="normal">773</span>
<span class="normal">774</span>
<span class="normal">775</span>
<span class="normal">776</span>
<span class="normal">777</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">plot_uncertainty</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">show_buffer</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">bounds</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">ax</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Axes</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Visualizes the uncertainty in the edge positions of the predicted device.</span>

<span class="sd">    This method plots the uncertainty associated with the positions of the edges of</span>
<span class="sd">    the device. The uncertainty is represented as a gradient, with areas of higher</span>
<span class="sd">    uncertainty indicating a greater likelihood of the edge position from run to run</span>
<span class="sd">    (due to inconsistencies in the fabrication process). This visualization can help</span>
<span class="sd">    in identifying areas within the device geometry that may require design</span>
<span class="sd">    adjustments to improve fabrication consistency.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    show_buffer : bool, optional</span>
<span class="sd">        If True, the buffer zones around the device will also be visualized. By</span>
<span class="sd">        default, it is set to True.</span>
<span class="sd">    bounds : Optional[tuple[tuple[int, int], tuple[int, int]]], optional</span>
<span class="sd">        Specifies the bounds for zooming into the device geometry, formatted as</span>
<span class="sd">        ((min_x, min_y), (max_x, max_y)). If &#39;max_x&#39; or &#39;max_y&#39; is set to &quot;end&quot;, it</span>
<span class="sd">        will be replaced with the corresponding dimension size of the device array.</span>
<span class="sd">        If None, the entire device geometry is visualized.</span>
<span class="sd">    ax : Optional[Axes], optional</span>
<span class="sd">        An existing matplotlib Axes object to draw the uncertainty visualization on.</span>
<span class="sd">        If None, a new figure and axes will be created. Defaults to None.</span>
<span class="sd">    **kwargs</span>
<span class="sd">        Additional matplotlib parameters for plot customization.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Axes</span>
<span class="sd">        The matplotlib Axes object containing the uncertainty visualization. This</span>
<span class="sd">        can be used for further customization or saving the plot after the method</span>
<span class="sd">        returns.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">uncertainty_array</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="mf">0.5</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">device_array</span><span class="p">)</span>

    <span class="n">mappable</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_plot_base</span><span class="p">(</span>
        <span class="n">plot_array</span><span class="o">=</span><span class="n">uncertainty_array</span><span class="p">,</span>
        <span class="n">show_buffer</span><span class="o">=</span><span class="n">show_buffer</span><span class="p">,</span>
        <span class="n">bounds</span><span class="o">=</span><span class="n">bounds</span><span class="p">,</span>
        <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">cbar</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">mappable</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
    <span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s2">&quot;Uncertainty (a.u.)&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ax</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="prefab.device.Device.predict" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">predict</span><span class="p">(</span><span class="n">model_name</span><span class="p">,</span> <span class="n">model_tags</span><span class="p">,</span> <span class="n">binarize</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Predict the nanofabrication outcome of the device using a specified model.</p>
<p>This method sends the device geometry to a serverless prediction service, which
uses a specified machine learning model to predict the outcome of the
nanofabrication process.</p>
<h5 id="prefab.device.Device.predict--parameters">Parameters</h5>
<p>model_name : str
    The name of the model to use for prediction.
model_tags : list[str]
    A list of tags associated with the model. These tags can be used to specify
    model versions or configurations.
binarize : bool, optional
    If True, the predicted device geometry will be binarized using a threshold
    method. This is useful for converting probabilistic predictions into binary
    geometries. Defaults to False.</p>
<h5 id="prefab.device.Device.predict--returns">Returns</h5>
<p>Device
    A new instance of the Device class with the predicted geometry.</p>
<h5 id="prefab.device.Device.predict--raises">Raises</h5>
<p>ValueError
    If the prediction service returns an error or if the response from the
    service cannot be processed correctly.</p>

          <details class="quote">
            <summary>Source code in <code>prefab/device.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">predict</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">model_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">model_tags</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
    <span class="n">binarize</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Device&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Predict the nanofabrication outcome of the device using a specified model.</span>

<span class="sd">    This method sends the device geometry to a serverless prediction service, which</span>
<span class="sd">    uses a specified machine learning model to predict the outcome of the</span>
<span class="sd">    nanofabrication process.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    model_name : str</span>
<span class="sd">        The name of the model to use for prediction.</span>
<span class="sd">    model_tags : list[str]</span>
<span class="sd">        A list of tags associated with the model. These tags can be used to specify</span>
<span class="sd">        model versions or configurations.</span>
<span class="sd">    binarize : bool, optional</span>
<span class="sd">        If True, the predicted device geometry will be binarized using a threshold</span>
<span class="sd">        method. This is useful for converting probabilistic predictions into binary</span>
<span class="sd">        geometries. Defaults to False.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Device</span>
<span class="sd">        A new instance of the Device class with the predicted geometry.</span>

<span class="sd">    Raises</span>
<span class="sd">    ------</span>
<span class="sd">    ValueError</span>
<span class="sd">        If the prediction service returns an error or if the response from the</span>
<span class="sd">        service cannot be processed correctly.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_predict</span><span class="p">(</span>
        <span class="n">model_name</span><span class="o">=</span><span class="n">model_name</span><span class="p">,</span>
        <span class="n">model_tags</span><span class="o">=</span><span class="n">model_tags</span><span class="p">,</span>
        <span class="n">model_type</span><span class="o">=</span><span class="s2">&quot;p&quot;</span><span class="p">,</span>
        <span class="n">binarize</span><span class="o">=</span><span class="n">binarize</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="prefab.device.Device.rotate" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">rotate</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Rotate the device geometry by a given angle.</p>
<h5 id="prefab.device.Device.rotate--parameters">Parameters</h5>
<p>angle : float
    The angle of rotation in degrees. Positive values mean counter-clockwise
    rotation.</p>
<h5 id="prefab.device.Device.rotate--returns">Returns</h5>
<p>Device
    A new instance of the Device with the rotated geometry.</p>

          <details class="quote">
            <summary>Source code in <code>prefab/device.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 988</span>
<span class="normal"> 989</span>
<span class="normal"> 990</span>
<span class="normal"> 991</span>
<span class="normal"> 992</span>
<span class="normal"> 993</span>
<span class="normal"> 994</span>
<span class="normal"> 995</span>
<span class="normal"> 996</span>
<span class="normal"> 997</span>
<span class="normal"> 998</span>
<span class="normal"> 999</span>
<span class="normal">1000</span>
<span class="normal">1001</span>
<span class="normal">1002</span>
<span class="normal">1003</span>
<span class="normal">1004</span>
<span class="normal">1005</span>
<span class="normal">1006</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">rotate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">angle</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Device&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Rotate the device geometry by a given angle.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    angle : float</span>
<span class="sd">        The angle of rotation in degrees. Positive values mean counter-clockwise</span>
<span class="sd">        rotation.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Device</span>
<span class="sd">        A new instance of the Device with the rotated geometry.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">rotated_device_array</span> <span class="o">=</span> <span class="n">geometry</span><span class="o">.</span><span class="n">rotate</span><span class="p">(</span>
        <span class="n">device_array</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">device_array</span><span class="p">,</span> <span class="n">angle</span><span class="o">=</span><span class="n">angle</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_copy</span><span class="p">(</span><span class="n">update</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;device_array&quot;</span><span class="p">:</span> <span class="n">rotated_device_array</span><span class="p">})</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="prefab.device.Device.semulate" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">semulate</span><span class="p">(</span><span class="n">model_name</span><span class="p">,</span> <span class="n">model_tags</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Simulate the appearance of the device as if viewed under a Scanning Electron
Microscope (SEM).</p>
<p>This method applies a specified machine learning model to transform the device
geometry into a style that resembles an SEM image. This can be useful for
visualizing how the device might appear under an SEM, which is often used for
inspecting the surface and composition of materials at high magnification.</p>
<h5 id="prefab.device.Device.semulate--parameters">Parameters</h5>
<p>model_name : str
    The name of the model to use for correction.
model_tags : list[str]
    A list of tags associated with the model. These tags can be used to specify
    model versions or configurations.</p>
<h5 id="prefab.device.Device.semulate--returns">Returns</h5>
<p>Device
    A new instance of the Device class with its geometry transformed to simulate
    an SEM image style.</p>

          <details class="quote">
            <summary>Source code in <code>prefab/device.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">semulate</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">model_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">model_tags</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Device&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Simulate the appearance of the device as if viewed under a Scanning Electron</span>
<span class="sd">    Microscope (SEM).</span>

<span class="sd">    This method applies a specified machine learning model to transform the device</span>
<span class="sd">    geometry into a style that resembles an SEM image. This can be useful for</span>
<span class="sd">    visualizing how the device might appear under an SEM, which is often used for</span>
<span class="sd">    inspecting the surface and composition of materials at high magnification.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    model_name : str</span>
<span class="sd">        The name of the model to use for correction.</span>
<span class="sd">    model_tags : list[str]</span>
<span class="sd">        A list of tags associated with the model. These tags can be used to specify</span>
<span class="sd">        model versions or configurations.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Device</span>
<span class="sd">        A new instance of the Device class with its geometry transformed to simulate</span>
<span class="sd">        an SEM image style.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_predict</span><span class="p">(</span>
        <span class="n">model_name</span><span class="o">=</span><span class="n">model_name</span><span class="p">,</span>
        <span class="n">model_tags</span><span class="o">=</span><span class="n">model_tags</span><span class="p">,</span>
        <span class="n">model_type</span><span class="o">=</span><span class="s2">&quot;s&quot;</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="prefab.device.Device.ternarize" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">ternarize</span><span class="p">(</span><span class="n">eta1</span><span class="o">=</span><span class="mi">1</span> <span class="o">/</span> <span class="mi">3</span><span class="p">,</span> <span class="n">eta2</span><span class="o">=</span><span class="mi">2</span> <span class="o">/</span> <span class="mi">3</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Ternarize the device geometry based on two thresholds.</p>
<h5 id="prefab.device.Device.ternarize--parameters">Parameters</h5>
<p>eta1 : float, optional
    The first threshold value for ternarization. Defaults to 1/3.
eta2 : float, optional
    The second threshold value for ternarization. Defaults to 2/3.</p>
<h5 id="prefab.device.Device.ternarize--returns">Returns</h5>
<p>Device
    A new instance of the Device with the ternarized geometry.</p>

          <details class="quote">
            <summary>Source code in <code>prefab/device.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">926</span>
<span class="normal">927</span>
<span class="normal">928</span>
<span class="normal">929</span>
<span class="normal">930</span>
<span class="normal">931</span>
<span class="normal">932</span>
<span class="normal">933</span>
<span class="normal">934</span>
<span class="normal">935</span>
<span class="normal">936</span>
<span class="normal">937</span>
<span class="normal">938</span>
<span class="normal">939</span>
<span class="normal">940</span>
<span class="normal">941</span>
<span class="normal">942</span>
<span class="normal">943</span>
<span class="normal">944</span>
<span class="normal">945</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">ternarize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">eta1</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">3</span><span class="p">,</span> <span class="n">eta2</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">/</span> <span class="mi">3</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Device&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Ternarize the device geometry based on two thresholds.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    eta1 : float, optional</span>
<span class="sd">        The first threshold value for ternarization. Defaults to 1/3.</span>
<span class="sd">    eta2 : float, optional</span>
<span class="sd">        The second threshold value for ternarization. Defaults to 2/3.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Device</span>
<span class="sd">        A new instance of the Device with the ternarized geometry.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">ternarized_device_array</span> <span class="o">=</span> <span class="n">geometry</span><span class="o">.</span><span class="n">ternarize</span><span class="p">(</span>
        <span class="n">device_array</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">device_array</span><span class="p">,</span> <span class="n">eta1</span><span class="o">=</span><span class="n">eta1</span><span class="p">,</span> <span class="n">eta2</span><span class="o">=</span><span class="n">eta2</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_copy</span><span class="p">(</span><span class="n">update</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;device_array&quot;</span><span class="p">:</span> <span class="n">ternarized_device_array</span><span class="p">})</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="prefab.device.Device.to_gds" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">to_gds</span><span class="p">(</span><span class="n">gds_path</span><span class="o">=</span><span class="s1">&#39;prefab_device.gds&#39;</span><span class="p">,</span> <span class="n">cell_name</span><span class="o">=</span><span class="s1">&#39;prefab_device&#39;</span><span class="p">,</span> <span class="n">gds_layer</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">contour_approx_mode</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Exports the device geometry as a GDSII file.</p>
<p>This method converts the device geometry into a format suitable for GDSII files.
The conversion involves contour approximation to simplify the geometry while
preserving essential features.</p>
<h5 id="prefab.device.Device.to_gds--parameters">Parameters</h5>
<p>gds_path : str, optional
    The path where the GDSII file will be saved. If not specified, the file is
    saved as "prefab_device.gds" in the current directory.
cell_name : str, optional
    The name of the cell within the GDSII file. If not specified, defaults to
    "prefab_device".
gds_layer : tuple[int, int], optional
    The layer and datatype to use within the GDSII file. Defaults to (1, 0).
contour_approx_mode : int, optional
    The mode of contour approximation used during the conversion. Defaults to 2,
    which corresponds to <code>cv2.CHAIN_APPROX_SIMPLE</code>, a method that compresses
    horizontal, vertical, and diagonal segments and leaves only their endpoints.</p>

          <details class="quote">
            <summary>Source code in <code>prefab/device.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">to_gds</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">gds_path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;prefab_device.gds&quot;</span><span class="p">,</span>
    <span class="n">cell_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;prefab_device&quot;</span><span class="p">,</span>
    <span class="n">gds_layer</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
    <span class="n">contour_approx_mode</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Exports the device geometry as a GDSII file.</span>

<span class="sd">    This method converts the device geometry into a format suitable for GDSII files.</span>
<span class="sd">    The conversion involves contour approximation to simplify the geometry while</span>
<span class="sd">    preserving essential features.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    gds_path : str, optional</span>
<span class="sd">        The path where the GDSII file will be saved. If not specified, the file is</span>
<span class="sd">        saved as &quot;prefab_device.gds&quot; in the current directory.</span>
<span class="sd">    cell_name : str, optional</span>
<span class="sd">        The name of the cell within the GDSII file. If not specified, defaults to</span>
<span class="sd">        &quot;prefab_device&quot;.</span>
<span class="sd">    gds_layer : tuple[int, int], optional</span>
<span class="sd">        The layer and datatype to use within the GDSII file. Defaults to (1, 0).</span>
<span class="sd">    contour_approx_mode : int, optional</span>
<span class="sd">        The mode of contour approximation used during the conversion. Defaults to 2,</span>
<span class="sd">        which corresponds to `cv2.CHAIN_APPROX_SIMPLE`, a method that compresses</span>
<span class="sd">        horizontal, vertical, and diagonal segments and leaves only their endpoints.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">gdstk_cell</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_device_to_gdstk</span><span class="p">(</span>
        <span class="n">cell_name</span><span class="o">=</span><span class="n">cell_name</span><span class="p">,</span>
        <span class="n">gds_layer</span><span class="o">=</span><span class="n">gds_layer</span><span class="p">,</span>
        <span class="n">contour_approx_mode</span><span class="o">=</span><span class="n">contour_approx_mode</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Saving GDS to &#39;</span><span class="si">{</span><span class="n">gds_path</span><span class="si">}</span><span class="s2">&#39;...&quot;</span><span class="p">)</span>
    <span class="n">gdstk_library</span> <span class="o">=</span> <span class="n">gdstk</span><span class="o">.</span><span class="n">Library</span><span class="p">()</span>
    <span class="n">gdstk_library</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">gdstk_cell</span><span class="p">)</span>
    <span class="n">gdstk_library</span><span class="o">.</span><span class="n">write_gds</span><span class="p">(</span><span class="n">outfile</span><span class="o">=</span><span class="n">gds_path</span><span class="p">,</span> <span class="n">max_points</span><span class="o">=</span><span class="mi">8190</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="prefab.device.Device.to_gdstk" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">to_gdstk</span><span class="p">(</span><span class="n">cell_name</span><span class="o">=</span><span class="s1">&#39;prefab_device&#39;</span><span class="p">,</span> <span class="n">gds_layer</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">contour_approx_mode</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Converts the device geometry to a GDSTK cell object.</p>
<p>This method prepares the device geometry for GDSII file export by converting it
into a GDSTK cell object. GDSTK is a Python module for creating and manipulating
GDSII layout files. The conversion involves contour approximation to simplify
the geometry while preserving essential features.</p>
<h5 id="prefab.device.Device.to_gdstk--parameters">Parameters</h5>
<p>cell_name : str, optional
    The name of the cell to be created. Defaults to "prefab_device".
gds_layer : tuple[int, int], optional
    The layer and datatype to use within the GDSTK cell. Defaults to (1, 0).
contour_approx_mode : int, optional
    The mode of contour approximation used during the conversion. Defaults to 2,
    which corresponds to <code>cv2.CHAIN_APPROX_SIMPLE</code>, a method that compresses
    horizontal, vertical, and diagonal segments and leaves only their endpoints.</p>
<h5 id="prefab.device.Device.to_gdstk--returns">Returns</h5>
<p>gdstk.Cell
    The GDSTK cell object representing the device geometry.</p>

          <details class="quote">
            <summary>Source code in <code>prefab/device.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">to_gdstk</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">cell_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;prefab_device&quot;</span><span class="p">,</span>
    <span class="n">gds_layer</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
    <span class="n">contour_approx_mode</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Converts the device geometry to a GDSTK cell object.</span>

<span class="sd">    This method prepares the device geometry for GDSII file export by converting it</span>
<span class="sd">    into a GDSTK cell object. GDSTK is a Python module for creating and manipulating</span>
<span class="sd">    GDSII layout files. The conversion involves contour approximation to simplify</span>
<span class="sd">    the geometry while preserving essential features.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    cell_name : str, optional</span>
<span class="sd">        The name of the cell to be created. Defaults to &quot;prefab_device&quot;.</span>
<span class="sd">    gds_layer : tuple[int, int], optional</span>
<span class="sd">        The layer and datatype to use within the GDSTK cell. Defaults to (1, 0).</span>
<span class="sd">    contour_approx_mode : int, optional</span>
<span class="sd">        The mode of contour approximation used during the conversion. Defaults to 2,</span>
<span class="sd">        which corresponds to `cv2.CHAIN_APPROX_SIMPLE`, a method that compresses</span>
<span class="sd">        horizontal, vertical, and diagonal segments and leaves only their endpoints.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    gdstk.Cell</span>
<span class="sd">        The GDSTK cell object representing the device geometry.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Creating cell &#39;</span><span class="si">{</span><span class="n">cell_name</span><span class="si">}</span><span class="s2">&#39;...&quot;</span><span class="p">)</span>
    <span class="n">gdstk_cell</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_device_to_gdstk</span><span class="p">(</span>
        <span class="n">cell_name</span><span class="o">=</span><span class="n">cell_name</span><span class="p">,</span>
        <span class="n">gds_layer</span><span class="o">=</span><span class="n">gds_layer</span><span class="p">,</span>
        <span class="n">contour_approx_mode</span><span class="o">=</span><span class="n">contour_approx_mode</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">gdstk_cell</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="prefab.device.Device.to_img" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">to_img</span><span class="p">(</span><span class="n">img_path</span><span class="o">=</span><span class="s1">&#39;prefab_device.png&#39;</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Exports the device geometry as an image file.</p>
<p>This method converts the device geometry to a numpy ndarray using <code>to_ndarray</code>,
scales the values to the range [0, 255] for image representation, and saves the
result as an image file.</p>
<h5 id="prefab.device.Device.to_img--parameters">Parameters</h5>
<p>img_path : str, optional
    The path where the image file will be saved. If not specified, the image is
    saved as "prefab_device.png" in the current directory.</p>

          <details class="quote">
            <summary>Source code in <code>prefab/device.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">to_img</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">img_path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;prefab_device.png&quot;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Exports the device geometry as an image file.</span>

<span class="sd">    This method converts the device geometry to a numpy ndarray using `to_ndarray`,</span>
<span class="sd">    scales the values to the range [0, 255] for image representation, and saves the</span>
<span class="sd">    result as an image file.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    img_path : str, optional</span>
<span class="sd">        The path where the image file will be saved. If not specified, the image is</span>
<span class="sd">        saved as &quot;prefab_device.png&quot; in the current directory.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">cv2</span><span class="o">.</span><span class="n">imwrite</span><span class="p">(</span><span class="n">img_path</span><span class="p">,</span> <span class="mi">255</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_ndarray</span><span class="p">())</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Saved Device to &#39;</span><span class="si">{</span><span class="n">img_path</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="prefab.device.Device.to_ndarray" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">to_ndarray</span><span class="p">()</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Converts the device geometry to a numpy ndarray.</p>
<p>This method applies the buffer specifications to crop the device array if
necessary, based on the buffer mode ('edge' or 'constant'). It then returns the
resulting numpy ndarray representing the device geometry.</p>
<h5 id="prefab.device.Device.to_ndarray--returns">Returns</h5>
<p>np.ndarray
    The numpy ndarray representation of the device geometry, with any applied
    buffer cropping.</p>

          <details class="quote">
            <summary>Source code in <code>prefab/device.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">to_ndarray</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Converts the device geometry to a numpy ndarray.</span>

<span class="sd">    This method applies the buffer specifications to crop the device array if</span>
<span class="sd">    necessary, based on the buffer mode (&#39;edge&#39; or &#39;constant&#39;). It then returns the</span>
<span class="sd">    resulting numpy ndarray representing the device geometry.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    np.ndarray</span>
<span class="sd">        The numpy ndarray representation of the device geometry, with any applied</span>
<span class="sd">        buffer cropping.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">device_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">device_array</span><span class="p">)</span>
    <span class="n">buffer_thickness</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">buffer_spec</span><span class="o">.</span><span class="n">thickness</span>
    <span class="n">buffer_mode</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">buffer_spec</span><span class="o">.</span><span class="n">mode</span>

    <span class="n">crop_top</span> <span class="o">=</span> <span class="n">buffer_thickness</span> <span class="k">if</span> <span class="n">buffer_mode</span><span class="p">[</span><span class="s2">&quot;top&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;edge&quot;</span> <span class="k">else</span> <span class="mi">0</span>
    <span class="n">crop_bottom</span> <span class="o">=</span> <span class="n">buffer_thickness</span> <span class="k">if</span> <span class="n">buffer_mode</span><span class="p">[</span><span class="s2">&quot;bottom&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;edge&quot;</span> <span class="k">else</span> <span class="mi">0</span>
    <span class="n">crop_left</span> <span class="o">=</span> <span class="n">buffer_thickness</span> <span class="k">if</span> <span class="n">buffer_mode</span><span class="p">[</span><span class="s2">&quot;left&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;edge&quot;</span> <span class="k">else</span> <span class="mi">0</span>
    <span class="n">crop_right</span> <span class="o">=</span> <span class="n">buffer_thickness</span> <span class="k">if</span> <span class="n">buffer_mode</span><span class="p">[</span><span class="s2">&quot;right&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;edge&quot;</span> <span class="k">else</span> <span class="mi">0</span>

    <span class="n">ndarray</span> <span class="o">=</span> <span class="n">device_array</span><span class="p">[</span>
        <span class="n">crop_top</span> <span class="p">:</span> <span class="n">device_array</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">crop_bottom</span><span class="p">,</span>
        <span class="n">crop_left</span> <span class="p">:</span> <span class="n">device_array</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">crop_right</span><span class="p">,</span>
    <span class="p">]</span>
    <span class="k">return</span> <span class="n">ndarray</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="prefab.device.Device.trim" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">trim</span><span class="p">()</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Trim the device geometry by removing empty space around it.</p>
<h5 id="prefab.device.Device.trim--parameters">Parameters</h5>
<p>buffer_thickness : int, optional
    The thickness of the buffer to leave around the empty space. Defaults to 0,
    which means no buffer is added.</p>
<h5 id="prefab.device.Device.trim--returns">Returns</h5>
<p>Device
    A new instance of the Device with the trimmed geometry.</p>

          <details class="quote">
            <summary>Source code in <code>prefab/device.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">947</span>
<span class="normal">948</span>
<span class="normal">949</span>
<span class="normal">950</span>
<span class="normal">951</span>
<span class="normal">952</span>
<span class="normal">953</span>
<span class="normal">954</span>
<span class="normal">955</span>
<span class="normal">956</span>
<span class="normal">957</span>
<span class="normal">958</span>
<span class="normal">959</span>
<span class="normal">960</span>
<span class="normal">961</span>
<span class="normal">962</span>
<span class="normal">963</span>
<span class="normal">964</span>
<span class="normal">965</span>
<span class="normal">966</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">trim</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Device&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Trim the device geometry by removing empty space around it.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    buffer_thickness : int, optional</span>
<span class="sd">        The thickness of the buffer to leave around the empty space. Defaults to 0,</span>
<span class="sd">        which means no buffer is added.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Device</span>
<span class="sd">        A new instance of the Device with the trimmed geometry.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">trimmed_device_array</span> <span class="o">=</span> <span class="n">geometry</span><span class="o">.</span><span class="n">trim</span><span class="p">(</span>
        <span class="n">device_array</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">device_array</span><span class="p">,</span>
        <span class="n">buffer_thickness</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">buffer_spec</span><span class="o">.</span><span class="n">thickness</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_copy</span><span class="p">(</span><span class="n">update</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;device_array&quot;</span><span class="p">:</span> <span class="n">trimmed_device_array</span><span class="p">})</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>


</div>




  </div>

  </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.instant", "navigation.sections"], "search": "../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.1e8ae164.min.js"></script>
      
    
  </body>
</html>